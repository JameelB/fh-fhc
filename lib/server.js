module.exports = server;
server.usage = ["",
				"fhc build app=<appId> domain=<domain> port=<port> package=<package>",
				"where domain is the domain where your the app is hosted",
				"'port' is not required, the default port is 8888",
				"'package' is not required, but is used to select the package directory to look in for files",
				""].join("\n");


var http = require("http"),
	https = require("https"),
	url = require("url"),
	path = require("path"),
	fs = require("fs"),
	common = require("./common"),
	mimeTypes = {
		js: "text/javascript",
		css: "text/css",
		html: "text/html",
		xml: "text/xml",
		txt: "text/plain"
	},
	defaultArgs = {
		baseDomain: {
			required: true,
			val: ".feedhenry.com"
		},
		port: {
			required: true,
			val: 8888
		},
		domain: {
			required: true
		},
		app: {
			required: true
		},
		package: {
			required: false
		}
	},
	lookupDirs = [
		'shared'
	],
	injection = {
		viewport: '<meta name="viewport" content="initial-scale = 1.0,maximum-scale = 1.0" />',
		device: "<script>if(!this.JSON){JSON=function(){function str(a,b){var c,d,e,f,g=gap,h,i=b[a];if(i\&\&typeof i===\"object\"\&\&typeof i.toJSON===\"function\"){i=i.toJSON(a)}if(typeof rep===\"function\"){i=rep.call(b,a,i)}switch(typeof i){case\"string\":return quote(i);case\"number\":return isFinite(i)?String(i):\"null\";case\"boolean\":case\"null\":return String(i);case\"object\":if(!i){return\"null\"}gap+=indent;h=[];if(typeof i.length===\"number\"\&\&!i.propertyIsEnumerable(\"length\")){f=i.length;for(c=0;c\x3Cf;c+=1){h[c]=str(c,i)||\"null\"}e=h.length===0?\"[]\":gap?\"[\\n\"+gap+h.join(\",\\n\"+gap)+\"\\n\"+g+\"]\":\"[\"+h.join(\",\")+\"]\";gap=g;return e}if(typeof rep===\"object\"){f=rep.length;for(c=0;c\x3Cf;c+=1){d=rep[c];if(typeof d===\"string\"){e=str(d,i,rep);if(e){h.push(quote(d)+(gap?\": \":\":\")+e)}}}}else{for(d in i){e=str(d,i,rep);if(e){h.push(quote(d)+(gap?\": \":\":\")+e)}}}e=h.length===0?\"{}\":gap?\"{\\n\"+gap+h.join(\",\\n\"+gap)+\"\\n\"+g+\"}\":\"{\"+h.join(\",\")+\"}\";gap=g;return e}}function quote(a){return escapeable.test(a)?\'\"\'+a.replace(escapeable,function(a){var b=meta[a];if(typeof b===\"string\"){return b}b=a.charCodeAt();return\"\\\\u00\"+Math.floor(b\x2F16).toString(16)+(b%16).toString(16)})+\'\"\':\'\"\'+a+\'\"\'}function f(a){return a\x3C10?\"0\"+a:a}Date.prototype.toJSON=function(){return this.getUTCFullYear()+\"-\"+f(this.getUTCMonth()+1)+\"-\"+f(this.getUTCDate())+\"T\"+f(this.getUTCHours())+\":\"+f(this.getUTCMinutes())+\":\"+f(this.getUTCSeconds())+\"Z\"};var escapeable=\x2F[\"\\\\\\x00-\\x1f\\x7f-\\x9f]\x2Fg,gap,indent,meta={\"\\b\":\"\\\\b\",\"\\t\":\"\\\\t\",\"\\n\":\"\\\\n\",\"\\f\":\"\\\\f\",\"\\r\":\"\\\\r\",\'\"\':\'\\\\\"\',\"\\\\\":\"\\\\\\\\\"},rep;return{stringify:function(a,b,c){var d;gap=\"\";indent=\"\";if(c){if(typeof c===\"number\"){for(d=0;d\x3Cc;d+=1){indent+=\" \"}}else if(typeof c===\"string\"){indent=c}}if(!b){rep=function(a,b){if(!Object.hasOwnProperty.call(this,a)){return undefined}return b}}else if(typeof b===\"function\"||typeof b===\"object\"\&\&typeof b.length===\"number\"){rep=b}else{throw new Error(\"JSON.stringify\")}return str(\"\",{\"\":a})},parse:function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e\&\&typeof e===\"object\"){for(c in e){if(Object.hasOwnProperty.call(e,c)){d=walk(e,c);if(d!==undefined){e[c]=d}else{delete e[c]}}}}return reviver.call(a,b,e)}var j;if(\x2F^[\\],:{}\\s]*$\x2F.test(text.replace(\x2F\\\\[\"\\\\\\\x2Fbfnrtu]\x2Fg,\"@\").replace(\x2F\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?\x2Fg,\"]\").replace(\x2F(?:^|:|,)(?:\\s*\\[)+\x2Fg,\"\"))){j=eval(\"(\"+text+\")\");return typeof reviver===\"function\"?walk({\"\":j},\"\"):j}throw new SyntaxError(\"JSON.parse\")},quote:quote}}()}(function(){if(window.google\&\&google.gears)return;var a=null;if(typeof GearsFactory!=\"undefined\"){a=new GearsFactory}else{try{a=new ActiveXObject(\"Gears.Factory\");if(a.getBuildInfo().indexOf(\"ie_mobile\")!=-1)a.privateSetGlobalObject(this)}catch(b){if(typeof navigator.mimeTypes!=\"undefined\"\&\&navigator.mimeTypes[\"application\x2Fx-googlegears\"]){a=document.createElement(\"object\");a.style.display=\"none\";a.width=0;a.height=0;a.type=\"application\x2Fx-googlegears\";document.documentElement.appendChild(a)}}}if(!a)return;if(!window.google)google={};if(!google.gears)google.gears={factory:a}})();Persist=function(){var a=\"0.2.0\",b,c,d,e,f,g;g=function(){var a=\"Thu, 01-Jan-1970 00:00:01 GMT\",b=1e3*60*60*24,c=[\"expires\",\"path\",\"domain\"],d=escape,e=unescape,f=document,g;var h=function(){var a=new Date;a.setTime(a.getTime());return a};var j=function(a,b){var e,f,g,h=[],i=arguments.length\x3E2?arguments[2]:{};h.push(d(a)+\"=\"+d(b));for(e=0;e\x3Cc.length;e++){f=c[e];if(g=i[f])h.push(f+\"=\"+g)}if(i.secure)h.push(\"secure\");return h.join(\"; \")};var k=function(){var a=\"__EC_TEST__\",b=new Date;b=b.toGMTString();this.set(a,b);this.enabled=this.remove(a)==b;return this.enabled};g={set:function(a,c){var d=arguments.length\x3E2?arguments[2]:{},e=h(),g,k={};if(d.expires){d.expires*=b;k.expires=new Date(e.getTime()+d.expires);k.expires=k.expires.toGMTString()}var l=[\"path\",\"domain\",\"secure\"];for(i=0;i\x3Cl.length;i++)if(d[l[i]])k[l[i]]=d[l[i]];var m=j(a,c,k);f.cookie=m;return c},has:function(a){a=d(a);var b=f.cookie,c=b.indexOf(a+\"=\"),e=c+a.length+1,g=b.substring(0,a.length);return!c\&\&a!=g||c\x3C0?false:true},get:function(a){a=d(a);var b=f.cookie,c=b.indexOf(a+\"=\"),g=c+a.length+1,h=b.substring(0,a.length),i;if(!c\&\&a!=h||c\x3C0)return null;i=b.indexOf(\";\",g);if(i\x3C0)i=b.length;return e(b.substring(g,i))},remove:function(b){var c=g.get(b),d={expires:a};f.cookie=j(b,\"\",d);return c},keys:function(){var a=f.cookie,b=a.split(\"; \"),c,d,g=[];for(c=0;c\x3Cb.length;c++){d=b[c].split(\"=\");g.push(e(d[0]))}return g},all:function(){var a=f.cookie,b=a.split(\"; \"),c,d,g=[];for(c=0;c\x3Cb.length;c++){d=b[c].split(\"=\");g.push([e(d[0]),e(d[1])])}return g},version:\"0.2.1\",enabled:false};g.enabled=k.call(g);return g}();var h=function(){if(Array.prototype.indexOf)return function(a,b){return Array.prototype.indexOf.call(a,b)};else return function(a,b){var c,d;for(c=0,d=a.length;c\x3Cd;c++)if(a[c]==b)return c;return-1}}();f=function(){};d=function(a){return\"PS\"+a.replace(\x2F_\x2Fg,\"__\").replace(\x2F \x2Fg,\"_s\")};C={search_order:[\"localstorage\",\"whatwg_db\",\"globalstorage\",\"gears\",\"ie\",\"flash\",\"cookie\"],name_re:\x2F^[a-z][a-z0-9_ -]+$\x2Fi,methods:[\"init\",\"get\",\"set\",\"remove\",\"load\",\"save\"],sql:{version:\"1\",create:\"CREATE TABLE IF NOT EXISTS persist_data (k TEXT UNIQUE NOT NULL PRIMARY KEY, v TEXT NOT NULL)\",get:\"SELECT v FROM persist_data WHERE k = ?\",set:\"INSERT INTO persist_data(k, v) VALUES (?, ?)\",remove:\"DELETE FROM persist_data WHERE k = ?\"},flash:{div_id:\"_persist_flash_wrap\",id:\"_persist_flash\",path:\"persist.swf\",size:{w:1,h:1},args:{autostart:true}}};c={gears:{size:-1,test:function(){return window.google\&\&window.google.gears?true:false},methods:{transaction:function(a){var b=this.db;b.execute(\"BEGIN\").close();a.call(this,b);b.execute(\"COMMIT\").close()},init:function(){var a;a=this.db=google.gears.factory.create(\"beta.database\");a.open(d(this.name));a.execute(C.sql.create).close()},get:function(a,b,c){var d,e=C.sql.get;if(!b)return;this.transaction(function(f){var g,h;d=f.execute(e,[a]);g=d.isValidRow();h=g?d.field(0):null;d.close();b.call(c||this,g,h)})},set:function(a,b,c,d){var e=C.sql.remove,f=C.sql.set,g;this.transaction(function(g){g.execute(e,[a]).close();g.execute(f,[a,b]).close();if(c)c.call(d||this,true,b)})},remove:function(a,b,c){var d=C.sql.get;sql=C.sql.remove,r,val=null,is_valid=false;this.transaction(function(e){if(b){r=e.execute(d,[a]);is_valid=r.isValidRow();val=is_valid?r.field(0):null;r.close()}if(!b||is_valid){e.execute(sql,[a]).close()}if(b)b.call(c||this,is_valid,val)})}}},whatwg_db:{size:200*1024,test:function(){var a=\"PersistJS Test\",b=\"Persistent database test.\";if(!window.openDatabase)return false;if(!window.openDatabase(a,C.sql.version,b,c.whatwg_db.size))return false;return true},methods:{transaction:function(a){if(!this.db_created){this.db.transaction(function(a){a.executeSql(C.sql.create,[],function(){this.db_created=true})},f)}this.db.transaction(a)},init:function(){this.db=openDatabase(this.name,C.sql.version,this.o.about||\"Persistent storage for \"+this.name,this.o.size||c.whatwg_db.size)},get:function(a,b,c){var d=C.sql.get;if(!b)return;c=c||this;this.transaction(function(e){e.executeSql(d,[a],function(a,d){if(d.rows.length\x3E0)b.call(c,true,d.rows.item(0)[\"v\"]);else b.call(c,false,null)})})},set:function(a,b,c,d){var e=C.sql.remove,f=C.sql.set;this.transaction(function(g){g.executeSql(e,[a],function(){g.executeSql(f,[a,b],function(a,e){if(c)c.call(d||this,true,b)})})});return b},remove:function(a,b,c){var d=C.sql.get;sql=C.sql.remove;this.transaction(function(e){if(b){e.executeSql(d,[a],function(d,e){if(e.rows.length\x3E0){var f=e.rows.item(0)[\"v\"];d.executeSql(sql,[a],function(a,d){b.call(c||this,true,f)})}else{b.call(c||this,false,null)}})}else{e.executeSql(sql,[a])}})}}},globalstorage:{size:5*1024*1024,test:function(){return window.globalStorage?true:false},methods:{key:function(a){return d(this.name)+d(a)},init:function(){alert(\"domain = \"+this.o.domain);this.store=globalStorage[this.o.domain]},get:function(a,b,c){a=this.key(a);if(b)b.call(c||this,true,this.store.getItem(a))},set:function(a,b,c,d){a=this.key(a);this.store.setItem(a,b);if(c)c.call(d||this,true,b)},remove:function(a,b,c){var d;a=this.key(a);d=this.store[a];this.store.removeItem(a);if(b)b.call(c||this,d!==null,d)}}},localstorage:{size:-1,test:function(){return window.localStorage?true:false},methods:{key:function(a){return d(this.name)+d(a)},init:function(){this.store=localStorage},get:function(a,b,c){a=this.key(a);if(b)b.call(c||this,true,this.store.getItem(a))},set:function(a,b,c,d){a=this.key(a);this.store.setItem(a,b);if(c)c.call(d||this,true,b)},remove:function(a,b,c){var d;a=this.key(a);d=this.store.getItem(a);this.store.removeItem(a);if(b)b.call(c||this,d!==null,d)}}},ie:{prefix:\"_persist_data-\",size:64*1024,test:function(){return window.ActiveXObject?true:false},make_userdata:function(a){var b=document.createElement(\"div\");b.id=a;b.style.display=\"none\";b.addBehavior(\"#default#userdata\");document.body.appendChild(b);return b},methods:{init:function(){var a=c.ie.prefix+d(this.name);this.el=c.ie.make_userdata(a);if(this.o.defer)this.load()},get:function(a,b,c){var e;a=d(a);if(!this.o.defer)this.load();e=this.el.getAttribute(a);if(b)b.call(c||this,e?true:false,e)},set:function(a,b,c,e){a=d(a);this.el.setAttribute(a,b);if(!this.o.defer)this.save();if(c)c.call(e||this,true,b)},remove:function(a,b,c){var e;a=d(a);if(!this.o.defer)this.load();e=this.el.getAttribute(a);this.el.removeAttribute(a);if(!this.o.defer)this.save();if(b)b.call(c||this,e?true:false,e)},load:function(){this.el.load(d(this.name))},save:function(){this.el.save(d(this.name))}}},cookie:{delim:\":\",size:4e3,test:function(){return b.Cookie.enabled?true:false},methods:{key:function(a){return this.name+c.cookie.delim+a},get:function(a,b,c){var d;a=this.key(a);d=g.get(a);if(b)b.call(c||this,d!=null,d)},set:function(a,b,c,d){a=this.key(a);g.set(a,b,this.o);if(c)c.call(d||this,true,b)},remove:function(a,b,c,d){var b;a=this.key(a);b=g.remove(a);if(c)c.call(d||this,b!=null,b)}}},flash:{test:function(){if(!deconcept||!deconcept.SWFObjectUtil)return false;var a=deconcept.SWFObjectUtil.getPlayerVersion().major;return a\x3E=8?true:false},methods:{init:function(){if(!c.flash.el){var a,b,d,e=C.flash;d=document.createElement(\"div\");d.id=e.div_id;document.body.appendChild(d);a=new deconcept.SWFObject(this.o.swf_path||e.path,e.id,e.size.w,e.size.h,\"8\");for(b in e.args)a.addVariable(b,e.args[b]);a.write(d);c.flash.el=document.getElementById(e.id)}this.el=c.flash.el},get:function(a,b,c){var e;a=d(a);e=this.el.get(this.name,a);if(b)b.call(c||this,e!==null,e)},set:function(a,b,c,e){var f;a=d(a);f=this.el.set(this.name,a,b);if(c)c.call(e||this,true,b)},remove:function(a,b,c){var e;a=d(a);e=this.el.remove(this.name,a);if(b)b.call(c||this,true,e)}}}};var e=function(){var a,d,e,g,h=C.methods,i=C.search_order;for(a=0,d=h.length;a\x3Cd;a++)b.Store.prototype[h[a]]=f;b.type=null;b.size=-1;for(a=0,d=i.length;!b.type\&\&a\x3Cd;a++){e=c[i[a]];if(e.test()){b.type=i[a];b.size=e.size;for(g in e.methods)b.Store.prototype[g]=e.methods[g]}}b._init=true};b={VERSION:a,type:null,size:0,add:function(a){c[a.id]=a;C.search_order=[a.id].concat(C.search_order);e()},remove:function(a){var b=h(C.search_order,a);if(b\x3C0)return;C.search_order.splice(b,1);delete c[a];e()},Cookie:g,Store:function(a,c){if(!C.name_re.exec(a))throw new Error(\"Invalid name\");if(!b.type)throw new Error(\"No suitable storage found\");c=c||{};this.name=a;c.domain=c.domain||location.host||\"localhost\";c.domain=c.domain.replace(\x2F:\\d+$\x2F,\"\");this.o=c;c.expires=c.expires||365*2;c.path=c.path||\"\x2F\";this.init()}};e();return b}();if(typeof deconcept==\"undefined\")var deconcept=new Object;if(typeof deconcept.util==\"undefined\")deconcept.util=new Object;if(typeof deconcept.SWFObjectUtil==\"undefined\")deconcept.SWFObjectUtil=new Object;deconcept.SWFObject=function(a,b,c,d,e,f,g,h,i,j){if(!document.getElementById){return}this.DETECT_KEY=j?j:\"detectflash\";this.skipDetect=deconcept.util.getRequestParameter(this.DETECT_KEY);this.params=new Object;this.variables=new Object;this.attributes=new Array;if(a){this.setAttribute(\"swf\",a)}if(b){this.setAttribute(\"id\",b)}if(c){this.setAttribute(\"width\",c)}if(d){this.setAttribute(\"height\",d)}if(e){this.setAttribute(\"version\",new deconcept.PlayerVersion(e.toString().split(\".\")))}this.installedVer=deconcept.SWFObjectUtil.getPlayerVersion();if(!window.opera\&\&document.all\&\&this.installedVer.major\x3E7){deconcept.SWFObject.doPrepUnload=true}if(f){this.addParam(\"bgcolor\",f)}var k=g?g:\"high\";this.addParam(\"quality\",k);this.setAttribute(\"useExpressInstall\",false);this.setAttribute(\"doExpressInstall\",false);var l=h?h:window.location;this.setAttribute(\"xiRedirectUrl\",l);this.setAttribute(\"redirectUrl\",\"\");if(i){this.setAttribute(\"redirectUrl\",i)}};deconcept.SWFObject.prototype={useExpressInstall:function(a){this.xiSWFPath=!a?\"expressinstall.swf\":a;this.setAttribute(\"useExpressInstall\",true)},setAttribute:function(a,b){this.attributes[a]=b},getAttribute:function(a){return this.attributes[a]},addParam:function(a,b){this.params[a]=b},getParams:function(){return this.params},addVariable:function(a,b){this.variables[a]=b},getVariable:function(a){return this.variables[a]},getVariables:function(){return this.variables},getVariablePairs:function(){var a=new Array;var b;var c=this.getVariables();for(b in c){a.push(b+\"=\"+c[b])}return a},getSWFHTML:function(){var a=\"\";if(navigator.plugins\&\&navigator.mimeTypes\&\&navigator.mimeTypes.length){if(this.getAttribute(\"doExpressInstall\")){this.addVariable(\"MMplayerType\",\"PlugIn\");this.setAttribute(\"swf\",this.xiSWFPath)}a=\'\x3Cembed type=\"application\x2Fx-shockwave-flash\" src=\"\'+this.getAttribute(\"swf\")+\'\" width=\"\'+this.getAttribute(\"width\")+\'\" height=\"\'+this.getAttribute(\"height\")+\'\"\';a+=\' id=\"\'+this.getAttribute(\"id\")+\'\" name=\"\'+this.getAttribute(\"id\")+\'\" \';var b=this.getParams();for(var c in b){a+=[c]+\'=\"\'+b[c]+\'\" \'}var d=this.getVariablePairs().join(\"\&\");if(d.length\x3E0){a+=\'flashvars=\"\'+d+\'\"\'}a+=\"\x2F\x3E\"}else{if(this.getAttribute(\"doExpressInstall\")){this.addVariable(\"MMplayerType\",\"ActiveX\");this.setAttribute(\"swf\",this.xiSWFPath)}a=\'\x3Cobject id=\"\'+this.getAttribute(\"id\")+\'\" classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" width=\"\'+this.getAttribute(\"width\")+\'\" height=\"\'+this.getAttribute(\"height\")+\'\"\x3E\';a+=\'\x3Cparam name=\"movie\" value=\"\'+this.getAttribute(\"swf\")+\'\" \x2F\x3E\';var b=this.getParams();for(var c in b){a+=\'\x3Cparam name=\"\'+c+\'\" value=\"\'+b[c]+\'\" \x2F\x3E\'}var d=this.getVariablePairs().join(\"\&\");if(d.length\x3E0){a+=\'\x3Cparam name=\"flashvars\" value=\"\'+d+\'\" \x2F\x3E\'}a+=\"\x3C\x2Fobject\x3E\"}return a},write:function(a){if(this.getAttribute(\"useExpressInstall\")){var b=new deconcept.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(b)\&\&!this.installedVer.versionIsValid(this.getAttribute(\"version\"))){this.setAttribute(\"doExpressInstall\",true);this.addVariable(\"MMredirectURL\",escape(this.getAttribute(\"xiRedirectUrl\")));document.title=document.title.slice(0,47)+\" - Flash Player Installation\";this.addVariable(\"MMdoctitle\",document.title)}}if(this.skipDetect||this.getAttribute(\"doExpressInstall\")||this.installedVer.versionIsValid(this.getAttribute(\"version\"))){var c=typeof a==\"string\"?document.getElementById(a):a;c.innerHTML=this.getSWFHTML();return true}else{if(this.getAttribute(\"redirectUrl\")!=\"\"){document.location.replace(this.getAttribute(\"redirectUrl\"))}}return false}};deconcept.SWFObjectUtil.getPlayerVersion=function(){var a=new deconcept.PlayerVersion([0,0,0]);if(navigator.plugins\&\&navigator.mimeTypes.length){var b=navigator.plugins[\"Shockwave Flash\"];if(b\&\&b.description){a=new deconcept.PlayerVersion(b.description.replace(\x2F([a-zA-Z]|\\s)+\x2F,\"\").replace(\x2F(\\s+r|\\s+b[0-9]+)\x2F,\".\").split(\".\"))}}else{try{var c=new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash.7\")}catch(d){try{var c=new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash.6\");a=new deconcept.PlayerVersion([6,0,21]);c.AllowScriptAccess=\"always\"}catch(d){if(a.major==6){return a}}try{c=new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash\")}catch(d){}}if(c!=null){a=new deconcept.PlayerVersion(c.GetVariable(\"$version\").split(\" \")[1].split(\",\"))}}return a};deconcept.PlayerVersion=function(a){this.major=a[0]!=null?parseInt(a[0]):0;this.minor=a[1]!=null?parseInt(a[1]):0;this.rev=a[2]!=null?parseInt(a[2]):0};deconcept.PlayerVersion.prototype.versionIsValid=function(a){if(this.major\x3Ca.major)return false;if(this.major\x3Ea.major)return true;if(this.minor\x3Ca.minor)return false;if(this.minor\x3Ea.minor)return true;if(this.rev\x3Ca.rev)return false;return true};deconcept.util={getRequestParameter:function(a){var b=document.location.search||document.location.hash;if(b){var c=b.substring(1).split(\"\&\");for(var d=0;d\x3Cc.length;d++){if(c[d].substring(0,c[d].indexOf(\"=\"))==a){return c[d].substring(c[d].indexOf(\"=\")+1)}}}return\"\"}};deconcept.SWFObjectUtil.cleanupSWFs=function(){var a=document.getElementsByTagName(\"OBJECT\");for(var b=0;b\x3Ca.length;b++){a[b].style.display=\"none\";for(var c in a[b]){if(typeof a[b][c]==\"function\"){a[b][c]=function(){}}}}};if(deconcept.SWFObject.doPrepUnload){deconcept.SWFObjectUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};window.attachEvent(\"onunload\",deconcept.SWFObjectUtil.cleanupSWFs)};window.attachEvent(\"onbeforeunload\",deconcept.SWFObjectUtil.prepUnload)}if(Array.prototype.push==null){Array.prototype.push=function(a){this[this.length]=a;return this.length}}var getQueryParamValue=deconcept.util.getRequestParameter;var FlashObject=deconcept.SWFObject;var SWFObject=deconcept.SWFObject;$fh={APP_MODE_DEBUG:\"debug\",APP_MODE_RELEASE:\"release\",APP_MODE_DISTRIBUTION:\"distribution\",CLOUD_TYPE_FH:\"fh\",CLOUD_TYPE_NODE:\"node\"};(function(){function j(a){if(a\&\&a.domain\&\&a.host){$fh.legacy.domain=a.domain;$fh.__setPathPrefix(a);$fh.legacy.widgetpath=$fh.legacy.pathprefix+\"wid\x2F\"+a.domain+\"\x2F\"+$fh.legacy.destinationName+\"\x2F\"+$fh.legacy.instance;$fh.legacy.path=$fh.legacy.pathprefix+\"wid\x2F\"+a.domain+\"\x2F\"+$fh.legacy.destinationName+\"\x2F\"+$fh.legacy.instance;$fh.legacy.filepath=$fh.legacy.path+\"\x2Ffile\x2F\"}}$fh.__is_ready=false;$fh.__ready_list=[];var a=false;var b=false;var c={security:\"fhext\x2Fjs\x2Fsecurity.js\"};var d=function(){if(!$fh.__is_ready){$fh.__is_ready=true;if($fh.__ready_list){try{while($fh.__ready_list[0]){$fh.__ready_list.shift().apply(document,[])}}finally{}$fh.__ready_list=null}}};$fh.__bind_ready=function(){if(a)return;a=true;if(document.addEventListener){document.addEventListener(\"DOMContentLoaded\",function(){document.removeEventListener(\"DOMContentLoaded\",arguments.callee,false);d()},false);window.addEventListener(\"load\",d,false)}else if(document.attachEvent){document.attachEvent(\"onreadystatechange\",function(){if(document.readyState===\"complete\"){document.detachEvent(\"onreadystatechange\",arguments.callee);d()}});window.attachEvent(\"onload\",d);if(document.documentElement.doScroll\&\&window==window.top)(function(){if($fh.__is_ready)return;try{document.documentElement.doScroll(\"left\")}catch(a){setTimeout(arguments.callee,0);return}d()})()}};$fh.__bind_ready();var e=window.ActiveXObject?ActiveXObject:XMLHttpRequest;var f=window.ActiveXObject?true:false;var g=function(){if(f){return new e(\"Microsoft.XMLHTTP\")}else{return new e}};var h=0;var i=function(a,b){var c;var d=document.head||document.getElementsByTagName(\"head\")[0]||document.documentElement;c=document.createElement(\"script\");c.async=\"async\";c.src=a;c.type=\"text\x2Fjavascript\";c.onload=c.onreadystatechange=function(){if(!c.readyState||\x2Floaded|complete\x2F.test(c.readyState)){c.onload=c.onreadystatechange=null;if(d\&\&c.parentNode){d.removeChild(c)}c=undefined;if(b\&\&typeof b===\"function\"){b()}}};d.insertBefore(c,d.firstChild)};$fh.__ajax=function(a){var b=a?a:{};var c;var d=b.url;var e=b.type||\"GET\";var f=b.data||null;var j;var k=\x2F\\?\x2F;var l=b.dataType===\"jsonp\"?\"jsonp\":\"json\";var m=function(a,d,e){var f=false;var g;var h;if(a\x3E=200\&\&a\x3C=300||a==304){if(a==304){d=\"notmodified\";f=true}else{if(b.dataType\&\&b.dataType.indexOf(\"json\")!=-1){try{if(typeof e===\"string\"){h=JSON.parse(e)}else{h=e}f=true}catch(i){f=false;d=\"parseerror\";g=i}}else{h=e;f=true}}}else{g=d;if(!d||a){d=\"error\";if(a\x3C0){a=0}}}if(f){c=undefined;if(b.success\&\&typeof b.success===\"function\"){b.success(h)}}else{if(b.error\&\&typeof b.error===\"function\"){b.error(c,d,g)}}};var n={json:function(){c=g();c.open(e,d,true);if(b.contentType){c.setRequestHeader(\"Content-Type\",b.contentType)}c.setRequestHeader(\"X-Request-With\",\"XMLHttpRequest\");var a=function(){if(c.readyState==4){if(j){clearTimeout(j)}var a;try{a=c.statusText}catch(b){a=\"\"}m(c.status,c.statusText,c.responseText)}};c.onreadystatechange=a;c.send(f)},jsonp:function(){var a=\"fhcb\"+h++;window[a]=function(b){if(j){clearTimeout(j)}m(200,\"\",b);window[a]=undefined;try{delete window[a]}catch(c){}};d+=(k.test(d)?\"\&\":\"?\")+\"callback=\"+a;i(d)}};if(b.timeout\x3E0){j=setTimeout(function(){if(c){c.abort()}m(0,\"timeout\")},b.timeout)}n[l]()};$fh.__load_module=function(a,b){if($fh[\"__\"+a+\"_loaded\"]){b();return}else{if(c[a]){i(c[a],b)}}};$fh.legacy={};$fh.__setPathPrefix=function(a){$fh.legacy.pathprefix=$fh.legacy.deliveryScheme+a.host+$fh.legacy.boxprefix};$fh.update_hostname_from_name_server=function(a){var b=\"fh_app_host_and_domain-\"+a;$fh.data({key:b},function(a){if(null!=a.val){j(JSON.parse(a.val))}},function(){});var c=$fh.legacy.nameserver+\"\x2Ffhns\x2Fapp\x2Fquery\x2F\"+a;$fh.__ajax({url:c,type:\"GET\",dataType:\"jsonp\",data:\"\",success:function(a){if(undefined!==a.host){j(a);$fh.data({act:\"save\",key:b,val:JSON.stringify(a)},function(a){},function(){})}},error:function(a,b,c){}})};$fh.init=function(a){$fh.legacy.domain=a.domain;$fh.legacy.nameserver=a.nameserver;$fh.legacy.deliveryScheme=a.deliveryScheme;$fh.legacy.checkDeliveryScheme=a.checkDeliveryScheme;$fh.legacy.appMode=a.appMode;$fh.legacy.debugCloudUrl=a.debugCloudUrl;$fh.legacy.debugCloudType=a.debugCloudType;$fh.legacy.releaseCloudUrl=a.releaseCloudUrl;$fh.legacy.releaseCloudType=a.releaseCloudType;$fh.legacy.destinationName=a.destination.name;$fh.legacy.destinationInline=a.destination.inline;$fh.legacy.widget=a.widget;$fh.legacy.instance=a.widget.instance;$fh.legacy.boxprefix=\"\x2Fbox\x2Fsrv\x2F1.1\x2F\";j(a);$fh.legacy.logPath=\"dat\x2FSwaggerLog\x2Flog\";$fh.legacy.entprefix=\"ent\x2F\";$fh.legacy.actprefix=\"act\x2F\";$fh.legacy.fh_timeout=2e4;$fh.legacy.debugpopup=false;$fh.legacy.logcalls=false;$fh.legacy.calllog=[];$fh.legacy.user=a.user;$fh.legacy.startwidget=null;$fh.legacy.oscontainer=null;$fh.legacy.messages={};$fh.legacy.polltimeout=null;$fh.legacy.urltag=a.urltag;$fh.legacy.urltagparam=\"\";$fh.legacy.swagger_view=a.swagger_view;$fh.legacy.useSecureConnection=a.useSecureConnection;$fh.host=a.host;if(a.urltag!=\"\"){$fh.legacy.urltagparam=\"?tag=\"+a.urltag}if($fh.legacy.destinationInline){var b=document.domain.split(\".\");document.domain=b[b.length-2]+\".\"+b[b.length-1]}if(typeof $fhcontainer!=\"undefined\"){$fh.legacy.container=$fhcontainer;$fh.legacy.container.addFhClient($fh.legacy)}return $fh.legacy};$fh.initialise=function(a){$fh.env({},function(a){$fh.data({key:\"__fhinit__\"},function(b){var c={};if(typeof b.val!=\"undefined\"\&\&b.val!=null\&\&b.val.length\x3E0){try{c=JSON.parse(b.val)}catch(d){c={}}}c.appid=a.application;c.instid=a.instance;c.uuid=a.uuid;c.destination=a.destination;c.app_version=a.version;c.domain=a.domain;c.agent=a.agent;var e=$fh.legacy.widgetpath+\"\x2Finitialise\";$fh.__ajax({type:\"POST\",url:e,data:JSON.stringify(c),success:function(a){$fh.data({act:\"save\",key:\"__fhinit__\",val:a})}})})})};$fh._getRequestUrl=function(a,b){return $fh.legacy.boxprefix+a};$fh._getCloudParams=function(a){return a};$fh._getCloudUri=function(a){var b=\"\";b=$fh._getInternalCloudPath(a.domain,a.code,a.act,a.guid);return b};$fh._getInternalCloudPath=function(a,b,c,d){var e;e=$fh.legacy.actprefix+a+\"\x2F\"+b+\"\x2F\"+c+\"\x2F\"+d;return e};$fh._addRequestParams=function(a,b){$fh.env({},function(c){var d={};d.cuid=c.uuid;d.destination=c.destination;d.domain=c.domain;d.version=c.version;a=a||{};a.__fh=d;a=$fh._getCloudParams(a);b(a)})};$fh.call=function(a,b,c,d,e,f){try{$fh._addRequestParams(b,function(b){var d=JSON.stringify(b);var g=a;if(a.indexOf(\"http\")\x3C0){g=$fh._getRequestUrl(a,e)}$fh.legacy.urltag==\"\"?\"\":g=g+(g.indexOf(\"?\")==-1?\"?\":\"\&\")+\"tag=\"+$fh.legacy.urltag;if($fh.legacy.debugpopup){alert(g+\" request:\"+d)}if($fh.legacy.logcalls){$fh.legacy.calllog.push(formatDate(new Date,true)+\": REQUEST: \"+g+\": \"+d)}var h={type:\"POST\",url:g,dataType:\"json\",contentType:\"application\x2Fjson\",cache:false,data:d,timeout:$fh.legacy.fh_timeout,success:function(a){if($fh.legacy.debugpopup){alert(g+\" response:\"+JSON.stringify(a))}if($fh.legacy.logcalls){$fh.legacy.calllog.push(formatDate(new Date,true)+\": RESPONSE: \"+g+\": \"+JSON.stringify(a))}if(c){c(a)}},error:function(a,b,c){$fh.legacy.error(a,b,c,f)}};$fh.__ajax(h)})}catch(g){console.log(g);var h=$fh.legacy.hostname+$fh.legacy.pathprefix+a;try{var i=new Ajax;i.responseType=Ajax.JSON;i.ondone=function(a){if(c){c(a)}};var j=JSON.stringify(req);var k={fh_fb_data:j};i.post(h,k)}catch(l){}}};$fh.legacy.call=$fh.call;$fh.legacy.error=function(a,b,c,d){var e=\"\";try{if(a){if(400==a.status||500==a.status){var f=JSON.parse(a.responseText);e=\"error(01): \"+f.msg;if($fh.legacy.debugpopup){alert(e)}if($fh.legacy.logcalls){$fh.legacy.calllog.push(formatDate(new Date,true)+\": ERROR: \"+e)}}else{e=\"error(02): \"+a.responseText+\" \"+b+\" \"+c;if($fh.legacy.debugpopup){alert(e)}if($fh.legacy.logcalls){$fh.legacy.calllog.push(formatDate(new Date,true)+\": ERROR: \"+e)}}}else{e=\"error(03): \"+b+\" \"+c;if($fh.legacy.debugpopup){alert(e)}if($fh.legacy.logcalls){$fh.legacy.calllog.push(formatDate(new Date,true)+\": ERROR: \"+e)}}}catch(c){e=\"error(04): \"+c;if($fh.legacy.debugpopup){alert(e)}if($fh.legacy.logcalls){$fh.legacy.calllog.push(formatDate(new Date,true)+\": ERROR: \"+e)}}if(e!=\"\"){e=\"An error occured with your app: \"+e;$fh.log({message:e})}if(d){var g=a.status==400?\"ent_badact\":\"ent_actfail\";d(g,{status:a.status,message:c,error:e})}};$fh.legacy.formatDate=function(a,b){var c=a.getFullYear();var d=a.getMonth()+1;var e=a.getDate();var f=a.getHours();var g=a.getMinutes();var h=a.getSeconds();var i=a.getMilliseconds();return c+\"-\"+$fh.legacy.pZ(d)+\"-\"+$fh.legacy.pZ(e)+\" \"+$fh.legacy.pZ(f)+\":\"+$fh.legacy.pZ(g)+\":\"+$fh.legacy.pZ(h)+(b?\":\"+i:\"\")};$fh.legacy.pZ=function(a){return(a\x3C0||a\x3E9?\"\":\"0\")+a};$fh.legacy.getAssetFiles=function(a){return $fh.legacy.filepath+a};$fh.legacy.makeStaticUrl=function(a){return\"\x2Fstatic\x2Fw\x2F\"+$fh.legacy.widget.guid+\"\x2F\"+$fh.legacy.widget.version+\"\x2F\"+a};$fh.legacy.debug=function(a){$fh.legacy.debugpopup=a};$fh.legacy.logEvent=function(a){$fh.call($fh.legacy.logPath,a)}})();(function(){var a={success:function(){},failure:function(){},params:{}};var b=function(b,c,d){var e=[null,null,null];var f=[null,null,null];var g=b.length;if(2\x3Cg){f[0]=b[g-3];f[1]=b[g-2];f[2]=b[g-1]}else if(2==g){f[1]=b[0];f[2]=b[1]}else if(1==g){f[2]=b[0]}var h=0,i=0;for(;h\x3C3;h++){var j=f[h];var k=typeof j;if(j\&\&0==i\&\&(\"object\"==k||\"boolean\"==k)){e[i++]=j}else if(j\&\&\"function\"==k){i=0==i?1:i;e[i++]=j}}if(null==e[0]){e[0]=c?c:a.params}else{var l=e[0];l._defaults=[];for(var m in c){if(c.hasOwnProperty(m)){if(typeof l[m]===\"undefined\"){l[m]=c[m];l._defaults.push(m)}}}}e[1]=null==e[1]?a.success:e[1];e[2]=null==e[2]?a.failure:e[2];d(e[0],e[1],e[2])};var c=function(a){var b=document.createElement(\"i\");return a in b||b.setAttribute\&\&b.setAttribute(a,\"return;\")||false};$fh._mapScriptLoaded=typeof google!=\"undefined\"\&\&typeof google.maps!=\"undefined\"\&\&typeof google.maps.Map!=\"undefined\";$fh._loadMapScript=function(){var a=document.createElement(\"script\");a.type=\"text\x2Fjavascript\";a.src=\"http:\x2F\x2Fmaps.google.com\x2Fmaps\x2Fapi\x2Fjs?sensor=true\&callback=$fh._mapLoaded\";document.body.appendChild(a)};$fh.__readCookieValue=function(a){var b=a+\"=\";var c=document.cookie.split(\";\");for(var d=0;d\x3Cc.length;d++){var e=c[d];while(e.charAt(0)==\" \"){e=e.substring(1,e.length)}if(e.indexOf(b)==0){return e.substring(b.length,e.length)}}return null};$fh.__createCookie=function(a,b){var c=new Date;c.setTime(c.getTime()+36500*24*60*60*1e3);var d=\"; expires=\"+c.toGMTString();document.cookie=a+\"=\"+b+d+\"; path = \x2F\"};$fh.__createUUID=function(){var a=[];var b=\"0123456789ABCDEF\";for(var c=0;c\x3C32;c++){a[c]=b.substr(Math.floor(Math.random()*16),1)}a[12]=\"4\";a[16]=b.substr(a[16]\&3|8,1);var d=a.join(\"\");return d};$fh._mock_uuid_cookie_name=\"mock_uuid\";$fh.audio_obj=null;$fh.audio_is_playing=false;$fh._current_auth_user=null;$fh.__dest__={send:function(a,b,c){c(\"send_nosupport\")},notify:function(a,b,c){c(\"notify_nosupport\")},contacts:function(a,b,c){c(\"contacts_nosupport\")},acc:function(a,b,c){c(\"acc_nosupport\")},geo:function(a,b,c){c(\"geo_nosupport\")},cam:function(a,b,c){c(\"cam_nosupport\")},device:function(a,b,c){c(\"device_nosupport\")},listen:function(a,b,c){c(\"listen_nosupport\")},handlers:function(a,b,c){c(\"handlers_no_support\")},file:function(a,b,c){c(\"file_nosupport\")},push:function(a,b,c){c(\"push_nosupport\")},env:function(a,b,c){b({height:window.innerHeight,width:window.innerWidth,uuid:function(){var a=$fh.__readCookieValue($fh._mock_uuid_cookie_name);if(null==a){a=$fh.__createUUID();$fh.__createCookie($fh._mock_uuid_cookie_name,a)}return a}()})},data:function(a,b,c){if(!$fh._persist){$fh._persist=new Persist.Store(\"FH\"+$fh.legacy.instance,{swf_path:\"\x2Fstatic\x2Fc\x2Fstart\x2Fswf\x2Fpersist.swf\"})}if(!a.key){c(\"data_nokey\");return}var d={load:function(){$fh._persist.get(a.key,function(c,d){c?b({key:a.key,val:d}):b({key:a.key,val:null})})},save:function(){if(!a.val){c(\"data_noval\");return}try{$fh._persist.set(a.key,a.val)}catch(d){c(\"data_error\",{},a);return}b()},remove:function(){$fh._persist.remove(a.key,function(c,d){c?b({key:a.key,val:d}):b({key:a.key,val:null})})}};d[a.act]?d[a.act]():c(\"data_badact\",a)},log:function(a,b,c){typeof console===\"undefined\"?c(\"log_nosupport\"):console.log(a.message)},ori:function(a,b,d){if(typeof a.act==\"undefined\"||a.act==\"listen\"){if(c(\"onorientationchange\")){window.addEventListener(\"orientationchange\",b,false)}else{d(\"ori_nosupport\",{},a)}}else if(a.act==\"set\"){if(!a.value){d(\"ori_no_value\",{},a);return}if(a.value==\"portrait\"){document.getElementsByTagName(\"body\")[0].style[\"-moz-transform\"]=\"\";document.getElementsByTagName(\"body\")[0].style[\"-webkit-transform\"]=\"\";b({orientation:\"portrait\"})}else{document.getElementsByTagName(\"body\")[0].style[\"-moz-transform\"]=\"rotate(90deg)\";document.getElementsByTagName(\"body\")[0].style[\"-webkit-transform\"]=\"rotate(90deg)\";b({orientation:\"landscape\"})}}else{d(\"ori_badact\",{},a)}},map:function(a,b,c){if(!a.target){c(\"map_notarget\",{},a);return}if(!a.lat){c(\"map_nolatitude\",{},a);return}if(!a.lon){c(\"map_nologitude\",{},a);return}var d=a.target;if(typeof d===\"string\"){var e=null;if(typeof jQuery!=\"undefined\"){try{var f=jQuery(d);if(f.length\x3E0){e=f[0]}}catch(g){e=null}}if(null==e){e=document.getElementById(d)}d=e}else if(typeof d===\"object\"){if(d.nodeType===1\&\&typeof d.nodeName===\"string\"){}else{d=d[0]}}else{d=null}if(!d){c(\"map_nocontainer\",{},a);return}if(!$fh._mapScriptLoaded){$fh._mapLoaded=function(){$fh._mapScriptLoaded=true;var c={};c.zoom=a.zoom?a.zoom:8;c.center=new google.maps.LatLng(a.lat,a.lon);c.mapTypeId=google.maps.MapTypeId.ROADMAP;var e=new google.maps.Map(d,c);b({map:e})};$fh._loadMapScript();setTimeout(function(){if(!$fh._mapScriptLoaded){c(\"map_timeout\",{},a)}},2e4)}else{var h={};h.zoom=a.zoom?a.zoom:8;h.center=new google.maps.LatLng(a.lat,a.lon);h.mapTypeId=google.maps.MapTypeId.ROADMAP;var i=new google.maps.Map(d,h);b({map:i})}},audio:function(a,b,c){if(!$fh.audio_obj==null\&\&a.act==\"play\"\&\&(!a.path||a.path==\"\")){c(\"no_audio_path\");return}var d={play:function(){if(null==$fh.audio_obj){$fh.audio_obj=document.createElement(\"audio\");if(!($fh.audio_obj.play?true:false)){c(\"audio_not_support\");return}if(a.type){var e=$fh.audio_obj.canPlayType(a.type);if(e==\"no\"||e==\"\"){c(\"audio_type_not_supported\");return}}$fh.audio_obj.src=a.path;if(a.controls){$fh.audio_obj.controls=\"controls\"}if(a.autoplay){$fh.audio_obj.autoplay=\"autoplay\"}if(a.loop){$fh.audio_obj.loop=\"loop\"}document.body.appendChild($fh.audio_obj);$fh.audio_obj.play();$fh.audio_is_playing=true;b()}else{if(a.path\&\&a.path!=$fh.audio_obj.src){if($fh.audio_is_playing){d[\"stop\"](true)}d[\"play\"]()}else{if(!$fh.audio_is_playing){$fh.audio_obj.play();$fh.audio_is_playing=true;b()}}}},pause:function(){if(null!=$fh.audio_obj\&\&$fh.audio_is_playing){if(typeof $fh.audio_obj.pause==\"function\"){$fh.audio_obj.pause()}else if(typeof $fh.audio_obj.stop==\"function\"){$fh.audio_obj.stop()}$fh.audio_is_playing=false;b()}else{c(\"no_audio_playing\")}},stop:function(a){if(null!=$fh.audio_obj){if(typeof $fh.audio_obj.stop==\"function\"){$fh.audio_obj.stop()}else if(typeof $fh.audio_obj.pause==\"function\"){$fh.audio_obj.pause()}document.body.removeChild($fh.audio_obj);$fh.audio_obj=null;$fh.audio_is_playing=false;if(!a){b()}}else{c(\"no_audio\")}}};d[a.act]?d[a.act]():c(\"data_badact\",a)},webview:function(a,b,c){c(\"webview_nosupport\")},ready:function(a,b,c){$fh.__bind_ready();if($fh.__is_ready){b.apply(document,[])}else{$fh.__ready_list.push(b)}},setUUID:function(a,b,c){$fh.__createCookie($fh._mock_uuid_cookie_name,a.uuid)},sec:function(a,b,c){c(\"sec_no_support\")},auth:function(a,b,c){var d={};var e=true;if(\"secure\"in a){e=a.secure}if(typeof a.type===\"undefined\"){d.type=\"default\";d.params={userId:a.user,password:a.password}}else{d=a}$fh._current_auth_user=d;$fh.env({},function(a){d.params.appId=a.instance;d.params.device=a.uuid;$fh.call(\"arm\x2Fuser\x2Fauth\",d,function(a){if(0==a.authcode){b()}else{c(a.message)}},null,e,function(a,b){c(a)})})}};$fh.send=function(){b(arguments,{type:\"email\"},$fh.__dest__.send)};$fh.notify=function(){b(arguments,{type:\"vibrate\"},$fh.__dest__.notify)};$fh.contacts=function(){b(arguments,{act:\"list\"},$fh.__dest__.contacts)};$fh.acc=function(){b(arguments,{act:\"register\",interval:0},$fh.__dest__.acc)};$fh.geo=function(){b(arguments,{act:\"register\",interval:0},$fh.__dest__.geo)};$fh.cam=function(){b(arguments,{act:\"picture\"},$fh.__dest__.cam)};$fh.data=function(){b(arguments,{act:\"load\"},$fh.__dest__.data)};$fh.log=function(){b(arguments,{message:\"none\"},$fh.__dest__.log)};$fh.device=function(){b(arguments,{},$fh.__dest__.device)};$fh.listen=function(){b(arguments,{act:\"add\"},$fh.__dest__.listen)};$fh.ori=function(){b(arguments,{},$fh.__dest__.ori)};$fh.map=function(){b(arguments,{},$fh.__dest__.map)};$fh.audio=function(){b(arguments,{},$fh.__dest__.audio)};$fh.webview=function(){b(arguments,{},$fh.__dest__.webview)};$fh.ready=function(){b(arguments,{},$fh.__dest__.ready)};$fh.setUUID=function(){b(arguments,{},$fh.__dest__.setUUID)};$fh.sec=function(){var a=arguments;$fh.__load_module(\"security\",function(){b(a,{},$fh.__dest__.sec)})};$fh.handlers=function(){b(arguments,{type:\"back\"},$fh.__dest__.handlers)};$fh.hash=function(){b(arguments,{algorithm:\"md5\"},function(a,b,c){var d={act:\"hash\",params:a};$fh.sec(d,b,c)})};$fh.auth=function(){b(arguments,{},$fh.__dest__.auth)};$fh.file=function(){b(arguments,{act:\"upload\"},$fh.__dest__.file)};$fh.push=function(){b(arguments,{},$fh.__dest__.push)};$fh.env=function(){b(arguments,{},function(a,b,c){$fh.__dest__.env({},function(a){a.domain=$fh.legacy.domain;a.application=$fh.legacy.widget.guid;a.template=null;a.instance=$fh.legacy.instance;a.install=null;a.version=$fh.legacy.widget.version;a.destination=$fh.legacy.destinationName;a.subscriber=$fh.legacy.user.id;a.agent=navigator.userAgent||\"unknown\";b(a)})})};$fh.device=function(){b(arguments,{},function(a,b,c){})};$fh.ent=function(a,c,d){var e=[a,c,d];if(a\&\&\"string\"==typeof a){e=[{path:a,req:c},d]}b(e,{act:\"list\"},function(a,b,c){var d=a.req;var e=a.domain||$fh.legacy.domain;var f=a.ent;var g=a.act;if(a.path){var h=a.path;var i=h.split(\"\x2F\");if(i.length\x3C2){throw\"Invalid path. Path must be either \x3Centity\x3E\x2F\x3Caction\x3E or \x3Cdomain\x3E\x2F\x3Centity\x3E\x2F\x3Caction\x3E\"}e=$fh.legacy.domain;f=i[0];g=i[1];if(i.length==3){e=i[0];f=i[1];g=i[2]}}d.widgetInstance=$fh.legacy.widget.instance;d.type=e+\"_\"+f;h=$fh.legacy.entprefix+e+\"\x2F\"+f+\"\x2F\"+g;$fh.call(h,d,b)})};$fh.legacy.ent=$fh.ent;$fh.geoip=function(){b(arguments,{act:\"get\"},function(a,b,c){if(\"get\"==a.act){$fh.call(\"act\x2Fwid\x2Fgeoip\x2Fresolve\",{instance:$fh.legacy.widget.instance,domain:$fh.legacy.domain},function(a){for(var c in a.geoip){a[c]=a[\"geoip\"][c]}b(a)})}else{c(\"geoip_badact\",a)}})};$fh.legacy.geoip=$fh.geoip;$fh.act=function(a,c,d,e,f){var g=[a,c,d];if(a\&\&\"string\"==typeof a){g=[{act:a,req:c,code:e,domain:f,secure:$fh.legacy.useSecureConnection},d]}b(g,{domain:$fh.legacy.domain,code:$fh.legacy.widget.guid,secure:$fh.legacy.useSecureConnection},function(a,b,c){var d,e;e={domain:a.domain,code:a.code,act:a.act,guid:$fh.legacy.instance,secure:a.secure};d=$fh._getCloudUri(e);a.req=a.req||{};$fh.call(d,a.req,b,null,a.secure,c)})};$fh.legacy.act=$fh.act;$fh.web=function(a,c,d){b(arguments,{method:\"GET\"},function(a,b,c){if(!a.url){c(\"bad_url\")}if(a.is_local){$fh.__ajax({url:a.url,type:\"GET\",dataType:\"html\",success:function(a){var c={};c.status=200;c.body=a;b(c)},error:function(){c()}})}else{$fh.call(\"act\x2Fwid\x2Fweb\",a,function(a){b(a)})}})};$fh.prefs=function(){b(arguments,{act:\"load\"},function(a,b,c){if(\"load\"==a.act){if(a.full){$fh.legacy.getFullPrefs(b)}else{$fh.legacy.loadPrefs(b)}}else if(\"save\"==a.act){$fh.legacy.savePrefs(a.prefs,b)}else{c(\"prefs_badact\",a)}})}})();$fh.legacy.makeStaticUrl=$fh.makeStaticUrl=function(a){return a};$fh._getCloudUri=function(a){var b,c,d,e,f;f=$fh.APP_MODE_RELEASE.toUpperCase()===$fh.legacy.appMode.toUpperCase()||$fh.APP_MODE_DISTRIBUTION.toUpperCase()===$fh.legacy.appMode.toUpperCase();if(f){b=$fh.legacy.releaseCloudUrl;e=$fh.legacy.releaseCloudType}else{b=$fh.legacy.debugCloudUrl;e=$fh.legacy.debugCloudType}if($fh.CLOUD_TYPE_NODE===e){c=\"\x2Fcloud\x2F\"+a.act}else{c=$fh.legacy.boxprefix+$fh._getInternalCloudPath(a.domain,a.code,a.act,a.guid)}b=a.secure?b.replace(\"http:\x2F\x2F\",\"https:\x2F\x2F\"):b.replace(\"https:\x2F\x2F\",\"http:\x2F\x2F\");if($fh.legacy.checkDeliveryScheme){b=b.replace(\"http:\x2F\x2F\",$fh.legacy.deliveryScheme);b=b.replace(\"https:\x2F\x2F\",$fh.legacy.deliveryScheme)}d=b+c;return d};$fh._getCloudParams=function(a){var b,c;b=$fh.APP_MODE_RELEASE.toUpperCase()===$fh.legacy.appMode.toUpperCase()||$fh.APP_MODE_DISTRIBUTION.toUpperCase()===$fh.legacy.appMode.toUpperCase();if(b){c=$fh.legacy.releaseCloudType}else{c=$fh.legacy.debugCloudType}if($fh.CLOUD_TYPE_NODE===c){}return a};$fh._getRequestUrl=function(a,b){var c=(b?$fh.legacy.pathprefix.replace(\"http:\x2F\x2F\",\"https:\x2F\x2F\"):$fh.legacy.pathprefix.replace(\"https:\x2F\x2F\",\"http:\x2F\x2F\"))+a;if($fh.legacy.checkDeliveryScheme){c=c.replace(\"http:\x2F\x2F\",$fh.legacy.deliveryScheme);c=c.replace(\"https:\x2F\x2F\",$fh.legacy.deliveryScheme)}return c};if(typeof PhoneGap===\"undefined\"){if(typeof DeviceInfo!==\"object\"){var DeviceInfo={}}var PhoneGap={queue:{ready:true,commands:[],timer:null},documentEventHandler:{},windowEventHandler:{}};PhoneGap.resources={base:true};PhoneGap.hasResource=function(a){return PhoneGap.resources[a]};PhoneGap.addResource=function(a){PhoneGap.resources[a]=true};PhoneGap.Channel=function(a){this.type=a;this.handlers={};this.guid=0;this.fired=false;this.enabled=true};PhoneGap.Channel.prototype.subscribe=function(a,b,c){if(a===null){return}var d=a;if(typeof b===\"object\"\&\&typeof a===\"function\"){d=PhoneGap.close(b,a)}c=c||d.observer_guid||a.observer_guid||this.guid++;d.observer_guid=c;a.observer_guid=c;this.handlers[c]=d;return c};PhoneGap.Channel.prototype.subscribeOnce=function(a,b){var c=null;var d=this;var e=function(){a.apply(b||null,arguments);d.unsubscribe(c)};if(this.fired){if(typeof b===\"object\"\&\&typeof a===\"function\"){a=PhoneGap.close(b,a)}a.apply(this,this.fireArgs)}else{c=this.subscribe(e)}return c};PhoneGap.Channel.prototype.unsubscribe=function(a){if(typeof a===\"function\"){a=a.observer_guid}this.handlers[a]=null;delete this.handlers[a]};PhoneGap.Channel.prototype.fire=function(a){if(this.enabled){var b=false;var c,d,e;for(c in this.handlers){if(this.handlers.hasOwnProperty(c)){d=this.handlers[c];if(typeof d===\"function\"){e=d.apply(this,arguments)===false;b=b||e}}}this.fired=true;this.fireArgs=arguments;return!b}return true};PhoneGap.Channel.join=function(a,b){var c=b.length;var d=function(){if(!--c){a()}};var e=c;var f;for(f=0;f\x3Ce;f++){if(!b[f].fired){b[f].subscribeOnce(d)}else{c--}}if(!c){a()}};PhoneGap.available=DeviceInfo.uuid!==undefined;PhoneGap.addConstructor=function(a){PhoneGap.onPhoneGapInit.subscribeOnce(function(){try{a()}catch(b){console.log(\"Failed to run constructor: \"+b)}})};if(!window.plugins){window.plugins={}}PhoneGap.addPlugin=function(a,b){if(!window.plugins[a]){window.plugins[a]=b}else{console.log(\"Error: Plugin \"+a+\" already exists.\")}};PhoneGap.onDOMContentLoaded=new PhoneGap.Channel(\"onDOMContentLoaded\");PhoneGap.onNativeReady=new PhoneGap.Channel(\"onNativeReady\");PhoneGap.onPhoneGapInit=new PhoneGap.Channel(\"onPhoneGapInit\");PhoneGap.onPhoneGapReady=new PhoneGap.Channel(\"onPhoneGapReady\");PhoneGap.onPhoneGapInfoReady=new PhoneGap.Channel(\"onPhoneGapInfoReady\");PhoneGap.onPhoneGapConnectionReady=new PhoneGap.Channel(\"onPhoneGapConnectionReady\");PhoneGap.onResume=new PhoneGap.Channel(\"onResume\");PhoneGap.onPause=new PhoneGap.Channel(\"onPause\");PhoneGap.onDestroy=new PhoneGap.Channel(\"onDestroy\");PhoneGap.onDestroy.subscribeOnce(function(){PhoneGap.shuttingDown=true});PhoneGap.shuttingDown=false;if(typeof _nativeReady!==\"undefined\"){PhoneGap.onNativeReady.fire()}PhoneGap.onDeviceReady=new PhoneGap.Channel(\"onDeviceReady\");PhoneGap.deviceReadyChannelsArray=[PhoneGap.onPhoneGapReady,PhoneGap.onPhoneGapInfoReady,PhoneGap.onPhoneGapConnectionReady];PhoneGap.deviceReadyChannelsMap={};PhoneGap.waitForInitialization=function(a){if(a){var b=new PhoneGap.Channel(a);PhoneGap.deviceReadyChannelsMap[a]=b;PhoneGap.deviceReadyChannelsArray.push(b)}};PhoneGap.initializationComplete=function(a){var b=PhoneGap.deviceReadyChannelsMap[a];if(b){b.fire()}};PhoneGap.Channel.join(function(){setTimeout(function(){if(PhoneGap.UsePolling){PhoneGap.JSCallbackPolling()}else{var a=prompt(\"usePolling\",\"gap_callbackServer:\");PhoneGap.UsePolling=a;if(a==\"true\"){PhoneGap.UsePolling=true;PhoneGap.JSCallbackPolling()}else{PhoneGap.UsePolling=false;PhoneGap.JSCallback()}}},1);PhoneGap.onPhoneGapInit.fire();PhoneGap.onPhoneGapReady.fire();PhoneGap.Channel.join(function(){prompt(\"\",\"gap_init:\");PhoneGap.onDeviceReady.fire()},PhoneGap.deviceReadyChannelsArray)},[PhoneGap.onDOMContentLoaded,PhoneGap.onNativeReady]);document.addEventListener(\"DOMContentLoaded\",function(){PhoneGap.onDOMContentLoaded.fire()},false);PhoneGap.m_document_addEventListener=document.addEventListener;PhoneGap.m_window_addEventListener=window.addEventListener;PhoneGap.addWindowEventHandler=function(a,b){PhoneGap.windowEventHandler[a]=b};PhoneGap.addDocumentEventHandler=function(a,b){PhoneGap.documentEventHandler[a]=b};document.addEventListener=function(a,b,c){var d=a.toLowerCase();if(d===\"deviceready\"){PhoneGap.onDeviceReady.subscribeOnce(b)}else if(d===\"resume\"){PhoneGap.onResume.subscribe(b);if(PhoneGap.onDeviceReady.fired){PhoneGap.onResume.fire()}}else if(d===\"pause\"){PhoneGap.onPause.subscribe(b)}else{if(d===\"backbutton\"){PhoneGap.exec(null,null,\"App\",\"overrideBackbutton\",[true])}else if(typeof PhoneGap.documentEventHandler[d]!==\"undefined\"){if(PhoneGap.documentEventHandler[d](d,b,true)){return}}PhoneGap.m_document_addEventListener.call(document,a,b,c)}};window.addEventListener=function(a,b,c){var d=a.toLowerCase();if(typeof PhoneGap.windowEventHandler[d]!==\"undefined\"){if(PhoneGap.windowEventHandler[d](d,b,true)){return}}PhoneGap.m_window_addEventListener.call(window,a,b,c)};PhoneGap.m_document_removeEventListener=document.removeEventListener;PhoneGap.m_window_removeEventListener=window.removeEventListener;document.removeEventListener=function(a,b,c){var d=a.toLowerCase();if(d===\"backbutton\"){PhoneGap.exec(null,null,\"App\",\"overrideBackbutton\",[false])}if(typeof PhoneGap.documentEventHandler[d]!==\"undefined\"){if(PhoneGap.documentEventHandler[d](d,b,false)){return}}PhoneGap.m_document_removeEventListener.call(document,a,b,c)};window.removeEventListener=function(a,b,c){var d=a.toLowerCase();if(typeof PhoneGap.windowEventHandler[d]!==\"undefined\"){if(PhoneGap.windowEventHandler[d](d,b,false)){return}}PhoneGap.m_window_removeEventListener.call(window,a,b,c)};PhoneGap.fireDocumentEvent=function(a,b){var c=document.createEvent(\"Events\");c.initEvent(a);if(b){for(var d in b){c[d]=b[d]}}document.dispatchEvent(c)};PhoneGap.fireWindowEvent=function(a,b){var c=document.createEvent(\"Events\");c.initEvent(a);if(b){for(var d in b){c[d]=b[d]}}window.dispatchEvent(c)};PhoneGap.stringify=function(a){if(typeof JSON===\"undefined\"){var b=\"[\";var c,d,e,f,g,h;for(c=0;c\x3Ca.length;c++){if(a[c]!==null){if(c\x3E0){b=b+\",\"}d=typeof a[c];if(d===\"number\"||d===\"boolean\"){b=b+a[c]}else if(a[c]instanceof Array){b=b+\"[\"+a[c]+\"]\"}else if(a[c]instanceof Object){e=true;b=b+\"{\";for(f in a[c]){if(a[c][f]!==null){if(!e){b=b+\",\"}b=b+\'\"\'+f+\'\":\';g=typeof a[c][f];if(g===\"number\"||g===\"boolean\"){b=b+a[c][f]}else if(typeof a[c][f]===\"function\"){b=b+\'\"\"\'}else if(a[c][f]instanceof Object){b=b+PhoneGap.stringify(a[c][f])}else{b=b+\'\"\'+a[c][f]+\'\"\'}e=false}}b=b+\"}\"}else{h=a[c].replace(\x2F\\\\\x2Fg,\"\\\\\\\\\");h=h.replace(\x2F\"\x2Fg,\'\\\\\"\');b=b+\'\"\'+h+\'\"\'}}}b=b+\"]\";return b}else{return JSON.stringify(a)}};PhoneGap.clone=function(a){var b,c;if(!a){return a}if(a instanceof Array){c=[];for(b=0;b\x3Ca.length;++b){c.push(PhoneGap.clone(a[b]))}return c}if(typeof a===\"function\"){return a}if(!(a instanceof Object)){return a}if(a instanceof Date){return a}c={};for(b in a){if(!(b in c)||c[b]!==a[b]){c[b]=PhoneGap.clone(a[b])}}return c};PhoneGap.callbackId=0;PhoneGap.callbacks={};PhoneGap.callbackStatus={NO_RESULT:0,OK:1,CLASS_NOT_FOUND_EXCEPTION:2,ILLEGAL_ACCESS_EXCEPTION:3,INSTANTIATION_EXCEPTION:4,MALFORMED_URL_EXCEPTION:5,IO_EXCEPTION:6,INVALID_ACTION:7,JSON_EXCEPTION:8,ERROR:9};PhoneGap.exec=function(success,fail,service,action,args){try{var callbackId=service+PhoneGap.callbackId++;if(success||fail){PhoneGap.callbacks[callbackId]={success:success,fail:fail}}var r=prompt(PhoneGap.stringify(args),\"gap:\"+PhoneGap.stringify([service,action,callbackId,true]));if(r.length\x3E0){eval(\"var v=\"+r+\";\");if(v.status===PhoneGap.callbackStatus.OK){if(success){try{success(v.message)}catch(e){console.log(\"Error in success callback: \"+callbackId+\" = \"+e)}if(!v.keepCallback){delete PhoneGap.callbacks[callbackId]}}return v.message}else if(v.status===PhoneGap.callbackStatus.NO_RESULT){if(!v.keepCallback){delete PhoneGap.callbacks[callbackId]}}else{console.log(\"Error: Status=\"+v.status+\" Message=\"+v.message);if(fail){try{fail(v.message)}catch(e1){console.log(\"Error in error callback: \"+callbackId+\" = \"+e1)}if(!v.keepCallback){delete PhoneGap.callbacks[callbackId]}}return null}}}catch(e2){console.log(\"Error: \"+e2)}};PhoneGap.callbackSuccess=function(a,b){if(PhoneGap.callbacks[a]){if(b.status===PhoneGap.callbackStatus.OK){try{if(PhoneGap.callbacks[a].success){PhoneGap.callbacks[a].success(b.message)}}catch(c){console.log(\"Error in success callback: \"+a+\" = \"+c)}}if(!b.keepCallback){delete PhoneGap.callbacks[a]}}};PhoneGap.callbackError=function(a,b){if(PhoneGap.callbacks[a]){try{if(PhoneGap.callbacks[a].fail){PhoneGap.callbacks[a].fail(b.message)}}catch(c){console.log(\"Error in error callback: \"+a+\" = \"+c)}if(!b.keepCallback){delete PhoneGap.callbacks[a]}}};PhoneGap.run_command=function(){if(!PhoneGap.available||!PhoneGap.queue.ready){return}PhoneGap.queue.ready=false;var a=PhoneGap.queue.commands.shift();if(PhoneGap.queue.commands.length===0){clearInterval(PhoneGap.queue.timer);PhoneGap.queue.timer=null}var b=[];var c=null;var d;for(d=1;d\x3Ca.length;d++){var e=a[d];if(e===undefined||e===null){e=\"\"}if(typeof e===\"object\"){c=e}else{b.push(encodeURIComponent(e))}}var f=\"gap:\x2F\x2F\"+a[0]+\"\x2F\"+b.join(\"\x2F\");if(c!==null){var g;var h=[];for(g in c){if(c.hasOwnProperty(g)\&\&typeof g===\"string\"){h.push(encodeURIComponent(g)+\"=\"+encodeURIComponent(c[g]))}}if(h.length\x3E0){f+=\"?\"+h.join(\"\&\")}}document.location=f};PhoneGap.JSCallbackPort=null;PhoneGap.JSCallbackToken=null;PhoneGap.JSCallback=function(){if(PhoneGap.shuttingDown){return}if(PhoneGap.UsePolling){PhoneGap.JSCallbackPolling();return}var xmlhttp=new XMLHttpRequest;xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState===4){if(PhoneGap.shuttingDown){return}if(xmlhttp.status===200){var msg=decodeURIComponent(xmlhttp.responseText);setTimeout(function(){try{var t=eval(msg)}catch(e){console.log(\"JSCallback: Message from Server: \"+msg);console.log(\"JSCallback Error: \"+e)}},1);setTimeout(PhoneGap.JSCallback,1)}else if(xmlhttp.status===404){setTimeout(PhoneGap.JSCallback,10)}else if(xmlhttp.status===403){console.log(\"JSCallback Error: Invalid token.  Stopping callbacks.\")}else if(xmlhttp.status===503){console.log(\"JSCallback Server Closed: Stopping callbacks.\")}else if(xmlhttp.status===400){console.log(\"JSCallback Error: Bad request.  Stopping callbacks.\")}else{console.log(\"JSCallback Error: Request failed.\");PhoneGap.UsePolling=true;PhoneGap.JSCallbackPolling()}}};if(PhoneGap.JSCallbackPort===null){PhoneGap.JSCallbackPort=prompt(\"getPort\",\"gap_callbackServer:\")}if(PhoneGap.JSCallbackToken===null){PhoneGap.JSCallbackToken=prompt(\"getToken\",\"gap_callbackServer:\")}xmlhttp.open(\"GET\",\"http:\x2F\x2F127.0.0.1:\"+PhoneGap.JSCallbackPort+\"\x2F\"+PhoneGap.JSCallbackToken,true);xmlhttp.send()};PhoneGap.JSCallbackPollingPeriod=50;PhoneGap.UsePolling=false;PhoneGap.JSCallbackPolling=function(){if(PhoneGap.shuttingDown){return}if(!PhoneGap.UsePolling){PhoneGap.JSCallback();return}var msg=prompt(\"\",\"gap_poll:\");if(msg){setTimeout(function(){try{var t=eval(\"\"+msg)}catch(e){console.log(\"JSCallbackPolling: Message from Server: \"+msg);console.log(\"JSCallbackPolling Error: \"+e)}},1);setTimeout(PhoneGap.JSCallbackPolling,1)}else{setTimeout(PhoneGap.JSCallbackPolling,PhoneGap.JSCallbackPollingPeriod)}};PhoneGap.createUUID=function(){return PhoneGap.UUIDcreatePart(4)+\"-\"+PhoneGap.UUIDcreatePart(2)+\"-\"+PhoneGap.UUIDcreatePart(2)+\"-\"+PhoneGap.UUIDcreatePart(2)+\"-\"+PhoneGap.UUIDcreatePart(6)};PhoneGap.UUIDcreatePart=function(a){var b=\"\";var c,d;for(c=0;c\x3Ca;c++){d=parseInt(Math.random()*256,0).toString(16);if(d.length===1){d=\"0\"+d}b+=d}return b};PhoneGap.close=function(a,b,c){if(typeof c===\"undefined\"){return function(){return b.apply(a,arguments)}}else{return function(){return b.apply(a,c)}}};PhoneGap.includeJavascript=function(a,b){var c=document.getElementsByTagName(\"head\")[0];var d=document.createElement(\"script\");d.type=\"text\x2Fjavascript\";if(typeof b===\"function\"){d.onload=b}d.src=a;c.appendChild(d)}}if(!PhoneGap.hasResource(\"accelerometer\")){PhoneGap.addResource(\"accelerometer\");var Acceleration=function(a,b,c){this.x=a;this.y=b;this.z=c;this.timestamp=(new Date).getTime()};var Accelerometer=function(){this.lastAcceleration=null;this.timers={}};Accelerometer.ERROR_MSG=[\"Not running\",\"Starting\",\"\",\"Failed to start\"];Accelerometer.prototype.getCurrentAcceleration=function(a,b,c){if(typeof a!==\"function\"){console.log(\"Accelerometer Error: successCallback is not a function\");return}if(b\&\&typeof b!==\"function\"){console.log(\"Accelerometer Error: errorCallback is not a function\");return}PhoneGap.exec(a,b,\"Accelerometer\",\"getAcceleration\",[])};Accelerometer.prototype.watchAcceleration=function(a,b,c){var d=c!==undefined?c.frequency:1e4;if(typeof a!==\"function\"){console.log(\"Accelerometer Error: successCallback is not a function\");return}if(b\&\&typeof b!==\"function\"){console.log(\"Accelerometer Error: errorCallback is not a function\");return}PhoneGap.exec(function(a){if(a\x3Cd+1e4){PhoneGap.exec(null,null,\"Accelerometer\",\"setTimeout\",[d+1e4])}},function(a){},\"Accelerometer\",\"getTimeout\",[]);var e=PhoneGap.createUUID();navigator.accelerometer.timers[e]=setInterval(function(){PhoneGap.exec(a,b,\"Accelerometer\",\"getAcceleration\",[])},d?d:1);return e};Accelerometer.prototype.clearWatch=function(a){if(a\&\&navigator.accelerometer.timers[a]!==undefined){clearInterval(navigator.accelerometer.timers[a]);delete navigator.accelerometer.timers[a]}};PhoneGap.addConstructor(function(){if(typeof navigator.accelerometer===\"undefined\"){navigator.accelerometer=new Accelerometer}})}if(!PhoneGap.hasResource(\"app\")){PhoneGap.addResource(\"app\");(function(){var a=function(){};a.prototype.clearCache=function(){PhoneGap.exec(null,null,\"App\",\"clearCache\",[])};a.prototype.loadUrl=function(a,b){PhoneGap.exec(null,null,\"App\",\"loadUrl\",[a,b])};a.prototype.cancelLoadUrl=function(){PhoneGap.exec(null,null,\"App\",\"cancelLoadUrl\",[])};a.prototype.clearHistory=function(){PhoneGap.exec(null,null,\"App\",\"clearHistory\",[])};a.prototype.backHistory=function(){PhoneGap.exec(null,null,\"App\",\"backHistory\",[])};a.prototype.overrideBackbutton=function(a){PhoneGap.exec(null,null,\"App\",\"overrideBackbutton\",[a])};a.prototype.exitApp=function(){return PhoneGap.exec(null,null,\"App\",\"exitApp\",[])};a.prototype.addWhiteListEntry=function(a,b){return PhoneGap.exec(null,null,\"App\",\"addWhiteListEntry\",[a,b])};PhoneGap.addConstructor(function(){navigator.app=new a})})()}if(!PhoneGap.hasResource(\"battery\")){PhoneGap.addResource(\"battery\");var Battery=function(){this._level=null;this._isPlugged=null;this._batteryListener=[];this._lowListener=[];this._criticalListener=[]};Battery.prototype.eventHandler=function(a,b,c){var d=navigator.battery;if(c){if(d._batteryListener.length===0\&\&d._lowListener.length===0\&\&d._criticalListener.length===0){PhoneGap.exec(d._status,d._error,\"Battery\",\"start\",[])}if(a===\"batterystatus\"){var e=d._batteryListener.indexOf(b);if(e===-1){d._batteryListener.push(b)}}else if(a===\"batterylow\"){var e=d._lowListener.indexOf(b);if(e===-1){d._lowListener.push(b)}}else if(a===\"batterycritical\"){var e=d._criticalListener.indexOf(b);if(e===-1){d._criticalListener.push(b)}}}else{if(a===\"batterystatus\"){var e=d._batteryListener.indexOf(b);if(e\x3E-1){d._batteryListener.splice(e,1)}}else if(a===\"batterylow\"){var e=d._lowListener.indexOf(b);if(e\x3E-1){d._lowListener.splice(e,1)}}else if(a===\"batterycritical\"){var e=d._criticalListener.indexOf(b);if(e\x3E-1){d._criticalListener.splice(e,1)}}if(d._batteryListener.length===0\&\&d._lowListener.length===0\&\&d._criticalListener.length===0){PhoneGap.exec(null,null,\"Battery\",\"stop\",[])}}};Battery.prototype._status=function(a){if(a){var b=this;if(b._level!=a.level||b._isPlugged!=a.isPlugged){PhoneGap.fireWindowEvent(\"batterystatus\",a);if(a.level==20||a.level==5){if(a.level==20){PhoneGap.fireWindowEvent(\"batterylow\",a)}else{PhoneGap.fireWindowEvent(\"batterycritical\",a)}}}b._level=a.level;b._isPlugged=a.isPlugged}};Battery.prototype._error=function(a){console.log(\"Error initializing Battery: \"+a)};PhoneGap.addConstructor(function(){if(typeof navigator.battery===\"undefined\"){navigator.battery=new Battery;PhoneGap.addWindowEventHandler(\"batterystatus\",navigator.battery.eventHandler);PhoneGap.addWindowEventHandler(\"batterylow\",navigator.battery.eventHandler);PhoneGap.addWindowEventHandler(\"batterycritical\",navigator.battery.eventHandler)}})}if(!PhoneGap.hasResource(\"camera\")){PhoneGap.addResource(\"camera\");var Camera=function(){this.successCallback=null;this.errorCallback=null;this.options=null};Camera.DestinationType={DATA_URL:0,FILE_URI:1};Camera.prototype.DestinationType=Camera.DestinationType;Camera.EncodingType={JPEG:0,PNG:1};Camera.prototype.EncodingType=Camera.EncodingType;Camera.MediaType={PICTURE:0,VIDEO:1,ALLMEDIA:2};Camera.prototype.MediaType=Camera.MediaType;Camera.PictureSourceType={PHOTOLIBRARY:0,CAMERA:1,SAVEDPHOTOALBUM:2};Camera.prototype.PictureSourceType=Camera.PictureSourceType;Camera.prototype.getPicture=function(a,b,c){if(typeof a!==\"function\"){console.log(\"Camera Error: successCallback is not a function\");return}if(b\&\&typeof b!==\"function\"){console.log(\"Camera Error: errorCallback is not a function\");return}if(c===null||typeof c===\"undefined\"){c={}}if(c.quality===null||typeof c.quality===\"undefined\"){c.quality=80}if(c.maxResolution===null||typeof c.maxResolution===\"undefined\"){c.maxResolution=0}if(c.destinationType===null||typeof c.destinationType===\"undefined\"){c.destinationType=Camera.DestinationType.DATA_URL}if(c.sourceType===null||typeof c.sourceType===\"undefined\"){c.sourceType=Camera.PictureSourceType.CAMERA}if(c.encodingType===null||typeof c.encodingType===\"undefined\"){c.encodingType=Camera.EncodingType.JPEG}if(c.mediaType===null||typeof c.mediaType===\"undefined\"){c.mediaType=Camera.MediaType.PICTURE}if(c.targetWidth===null||typeof c.targetWidth===\"undefined\"){c.targetWidth=-1}else if(typeof c.targetWidth==\"string\"){var d=new Number(c.targetWidth);if(isNaN(d)===false){c.targetWidth=d.valueOf()}}if(c.targetHeight===null||typeof c.targetHeight===\"undefined\"){c.targetHeight=-1}else if(typeof c.targetHeight==\"string\"){var e=new Number(c.targetHeight);if(isNaN(e)===false){c.targetHeight=e.valueOf()}}PhoneGap.exec(a,b,\"Camera\",\"takePicture\",[c])};PhoneGap.addConstructor(function(){if(typeof navigator.camera===\"undefined\"){navigator.camera=new Camera}})}if(!PhoneGap.hasResource(\"capture\")){PhoneGap.addResource(\"capture\");var MediaFile=function(a,b,c,d,e){this.name=a||null;this.fullPath=b||null;this.type=c||null;this.lastModifiedDate=d||null;this.size=e||0};MediaFile.prototype.getFormatData=function(a,b){PhoneGap.exec(a,b,\"Capture\",\"getFormatData\",[this.fullPath,this.type])};var MediaFileData=function(a,b,c,d,e){this.codecs=a||null;this.bitrate=b||0;this.height=c||0;this.width=d||0;this.duration=e||0};var CaptureError=function(){this.code=null};CaptureError.CAPTURE_INTERNAL_ERR=0;CaptureError.CAPTURE_APPLICATION_BUSY=1;CaptureError.CAPTURE_INVALID_ARGUMENT=2;CaptureError.CAPTURE_NO_MEDIA_FILES=3;CaptureError.CAPTURE_NOT_SUPPORTED=20;var Capture=function(){this.supportedAudioModes=[];this.supportedImageModes=[];this.supportedVideoModes=[]};Capture.prototype.captureAudio=function(a,b,c){PhoneGap.exec(a,b,\"Capture\",\"captureAudio\",[c])};Capture.prototype.captureImage=function(a,b,c){PhoneGap.exec(a,b,\"Capture\",\"captureImage\",[c])};Capture.prototype._castMediaFile=function(a){var b=[];var c;for(c=0;c\x3Ca.message.length;c++){var d=new MediaFile;d.name=a.message[c].name;d.fullPath=a.message[c].fullPath;d.type=a.message[c].type;d.lastModifiedDate=a.message[c].lastModifiedDate;d.size=a.message[c].size;b.push(d)}a.message=b;return a};Capture.prototype.captureVideo=function(a,b,c){PhoneGap.exec(a,b,\"Capture\",\"captureVideo\",[c])};var ConfigurationData=function(){this.type=null;this.height=0;this.width=0};var CaptureImageOptions=function(){this.limit=1;this.mode=null};var CaptureVideoOptions=function(){this.limit=1;this.duration=0;this.mode=null};var CaptureAudioOptions=function(){this.limit=1;this.duration=0;this.mode=null};PhoneGap.addConstructor(function(){if(typeof navigator.device===\"undefined\"){navigator.device=window.device=new Device}if(typeof navigator.device.capture===\"undefined\"){navigator.device.capture=window.device.capture=new Capture}})}if(!PhoneGap.hasResource(\"compass\")){PhoneGap.addResource(\"compass\");CompassError=function(){this.code=null};CompassError.COMPASS_INTERNAL_ERR=0;CompassError.COMPASS_NOT_SUPPORTED=20;CompassHeading=function(){this.magneticHeading=null;this.trueHeading=null;this.headingAccuracy=null;this.timestamp=null};var Compass=function(){this.lastHeading=null;this.timers={}};Compass.ERROR_MSG=[\"Not running\",\"Starting\",\"\",\"Failed to start\"];Compass.prototype.getCurrentHeading=function(a,b,c){if(typeof a!==\"function\"){console.log(\"Compass Error: successCallback is not a function\");return}if(b\&\&typeof b!==\"function\"){console.log(\"Compass Error: errorCallback is not a function\");return}PhoneGap.exec(a,b,\"Compass\",\"getHeading\",[])};Compass.prototype.watchHeading=function(a,b,c){var d=c!==undefined?c.frequency:100;if(typeof a!==\"function\"){console.log(\"Compass Error: successCallback is not a function\");return}if(b\&\&typeof b!==\"function\"){console.log(\"Compass Error: errorCallback is not a function\");return}PhoneGap.exec(function(a){if(a\x3Cd+1e4){PhoneGap.exec(null,null,\"Compass\",\"setTimeout\",[d+1e4])}},function(a){},\"Compass\",\"getTimeout\",[]);var e=PhoneGap.createUUID();navigator.compass.timers[e]=setInterval(function(){PhoneGap.exec(a,b,\"Compass\",\"getHeading\",[])},d?d:1);return e};Compass.prototype.clearWatch=function(a){if(a\&\&navigator.compass.timers[a]){clearInterval(navigator.compass.timers[a]);delete navigator.compass.timers[a]}};Compass.prototype._castDate=function(a){if(a.message.timestamp){var b=new Date(a.message.timestamp);a.message.timestamp=b}return a};PhoneGap.addConstructor(function(){if(typeof navigator.compass===\"undefined\"){navigator.compass=new Compass}})}if(!PhoneGap.hasResource(\"contact\")){PhoneGap.addResource(\"contact\");var Contact=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){this.id=a||null;this.rawId=null;this.displayName=b||null;this.name=c||null;this.nickname=d||null;this.phoneNumbers=e||null;this.emails=f||null;this.addresses=g||null;this.ims=h||null;this.organizations=i||null;this.birthday=j||null;this.note=k||null;this.photos=l||null;this.categories=m||null;this.urls=n||null};var ContactError=function(){this.code=null};ContactError.UNKNOWN_ERROR=0;ContactError.INVALID_ARGUMENT_ERROR=1;ContactError.TIMEOUT_ERROR=2;ContactError.PENDING_OPERATION_ERROR=3;ContactError.IO_ERROR=4;ContactError.NOT_SUPPORTED_ERROR=5;ContactError.PERMISSION_DENIED_ERROR=20;Contact.prototype.remove=function(a,b){if(this.id===null){var c=new ContactError;c.code=ContactError.UNKNOWN_ERROR;b(c)}else{PhoneGap.exec(a,b,\"Contacts\",\"remove\",[this.id])}};Contact.prototype.clone=function(){var a=PhoneGap.clone(this);var b;a.id=null;a.rawId=null;if(a.phoneNumbers){for(b=0;b\x3Ca.phoneNumbers.length;b++){a.phoneNumbers[b].id=null}}if(a.emails){for(b=0;b\x3Ca.emails.length;b++){a.emails[b].id=null}}if(a.addresses){for(b=0;b\x3Ca.addresses.length;b++){a.addresses[b].id=null}}if(a.ims){for(b=0;b\x3Ca.ims.length;b++){a.ims[b].id=null}}if(a.organizations){for(b=0;b\x3Ca.organizations.length;b++){a.organizations[b].id=null}}if(a.tags){for(b=0;b\x3Ca.tags.length;b++){a.tags[b].id=null}}if(a.photos){for(b=0;b\x3Ca.photos.length;b++){a.photos[b].id=null}}if(a.urls){for(b=0;b\x3Ca.urls.length;b++){a.urls[b].id=null}}return a};Contact.prototype.save=function(a,b){PhoneGap.exec(a,b,\"Contacts\",\"save\",[this])};var ContactName=function(a,b,c,d,e,f){this.formatted=a||null;this.familyName=b||null;this.givenName=c||null;this.middleName=d||null;this.honorificPrefix=e||null;this.honorificSuffix=f||null};var ContactField=function(a,b,c){this.id=null;this.type=a||null;this.value=b||null;this.pref=c||null};var ContactAddress=function(a,b,c,d,e,f,g,h){this.id=null;this.pref=a||null;this.type=b||null;this.formatted=c||null;this.streetAddress=d||null;this.locality=e||null;this.region=f||null;this.postalCode=g||null;this.country=h||null};var ContactOrganization=function(a,b,c,d,e){this.id=null;this.pref=a||null;this.type=b||null;this.name=c||null;this.department=d||null;this.title=e||null};var Contacts=function(){this.inProgress=false;this.records=[]};Contacts.prototype.find=function(a,b,c,d){if(b===null){throw new TypeError(\"You must specify a success callback for the find command.\")}if(a===null||a===\"undefined\"||a.length===\"undefined\"||a.length\x3C=0){if(typeof c===\"function\"){c({code:ContactError.INVALID_ARGUMENT_ERROR})}}else{PhoneGap.exec(b,c,\"Contacts\",\"search\",[a,d])}};Contacts.prototype.insert=function(a,b){PhoneGap.exec(a,b,\"Contacts\",\"insert\",[[],{}])};Contacts.prototype.choose=function(a,b){PhoneGap.exec(a,b,\"Contacts\",\"choose\",[[],{}])};Contacts.prototype.create=function(a){var b;var c=new Contact;for(b in a){if(c[b]!==\"undefined\"){c[b]=a[b]}}return c};Contacts.prototype.cast=function(a){var b=[];var c;for(c=0;c\x3Ca.message.length;c++){b.push(navigator.contacts.create(a.message[c]))}a.message=b;return a};var ContactFindOptions=function(a,b){this.filter=a||\"\";this.multiple=b||false};PhoneGap.addConstructor(function(){if(typeof navigator.contacts===\"undefined\"){navigator.contacts=new Contacts}})}if(!PhoneGap.hasResource(\"crypto\")){PhoneGap.addResource(\"crypto\");var Crypto=function(){};Crypto.prototype.encrypt=function(a,b,c){this.encryptWin=c;PhoneGap.exec(null,null,\"Crypto\",\"encrypt\",[a,b])};Crypto.prototype.decrypt=function(a,b,c){this.decryptWin=c;PhoneGap.exec(null,null,\"Crypto\",\"decrypt\",[a,b])};Crypto.prototype.gotCryptedString=function(a){this.encryptWin(a)};Crypto.prototype.getPlainString=function(a){this.decryptWin(a)};PhoneGap.addConstructor(function(){if(typeof navigator.Crypto===\"undefined\"){navigator.Crypto=new Crypto}})}if(!PhoneGap.hasResource(\"device\")){PhoneGap.addResource(\"device\");var Device=function(){this.available=PhoneGap.available;this.platform=null;this.version=null;this.name=null;this.uuid=null;this.phonegap=null;var a=this;this.getInfo(function(b){a.available=true;a.platform=b.platform;a.version=b.version;a.name=b.name;a.uuid=b.uuid;a.phonegap=b.phonegap;PhoneGap.onPhoneGapInfoReady.fire()},function(b){a.available=false;console.log(\"Error initializing PhoneGap: \"+b);alert(\"Error initializing PhoneGap: \"+b)})};Device.prototype.getInfo=function(a,b){if(typeof a!==\"function\"){console.log(\"Device Error: successCallback is not a function\");return}if(b\&\&typeof b!==\"function\"){console.log(\"Device Error: errorCallback is not a function\");return}PhoneGap.exec(a,b,\"Device\",\"getDeviceInfo\",[])};Device.prototype.overrideBackButton=function(){console.log(\"Device.overrideBackButton() is deprecated.  Use App.overrideBackbutton(true).\");navigator.app.overrideBackbutton(true)};Device.prototype.resetBackButton=function(){console.log(\"Device.resetBackButton() is deprecated.  Use App.overrideBackbutton(false).\");navigator.app.overrideBackbutton(false)};Device.prototype.exitApp=function(){console.log(\"Device.exitApp() is deprecated.  Use App.exitApp().\");navigator.app.exitApp()};PhoneGap.addConstructor(function(){if(typeof navigator.device===\"undefined\"){navigator.device=window.device=new Device}})}if(!PhoneGap.hasResource(\"file\")){PhoneGap.addResource(\"file\");var FileProperties=function(a){this.filePath=a;this.size=0;this.lastModifiedDate=null};var File=function(a,b,c,d,e){this.name=a||null;this.fullPath=b||null;this.type=c||null;this.lastModifiedDate=d||null;this.size=e||0};var FileError=function(){this.code=null};FileError.NOT_FOUND_ERR=1;FileError.SECURITY_ERR=2;FileError.ABORT_ERR=3;FileError.NOT_READABLE_ERR=4;FileError.ENCODING_ERR=5;FileError.NO_MODIFICATION_ALLOWED_ERR=6;FileError.INVALID_STATE_ERR=7;FileError.SYNTAX_ERR=8;FileError.INVALID_MODIFICATION_ERR=9;FileError.QUOTA_EXCEEDED_ERR=10;FileError.TYPE_MISMATCH_ERR=11;FileError.PATH_EXISTS_ERR=12;var FileReader=function(){this.fileName=\"\";this.readyState=0;this.result=null;this.error=null;this.onloadstart=null;this.onprogress=null;this.onload=null;this.onerror=null;this.onloadend=null;this.onabort=null};FileReader.EMPTY=0;FileReader.LOADING=1;FileReader.DONE=2;FileReader.prototype.abort=function(){var a;this.readyState=FileReader.DONE;this.result=null;var b=new FileError;b.code=b.ABORT_ERR;this.error=b;if(typeof this.onerror===\"function\"){this.onerror({type:\"error\",target:this})}if(typeof this.onabort===\"function\"){this.onabort({type:\"abort\",target:this})}if(typeof this.onloadend===\"function\"){this.onloadend({type:\"loadend\",target:this})}};FileReader.prototype.readAsText=function(a,b){this.fileName=\"\";if(typeof a.fullPath===\"undefined\"){this.fileName=a}else{this.fileName=a.fullPath}this.readyState=FileReader.LOADING;if(typeof this.onloadstart===\"function\"){this.onloadstart({type:\"loadstart\",target:this})}var c=b?b:\"UTF-8\";var d=this;PhoneGap.exec(function(a){var b;if(d.readyState===FileReader.DONE){return}d.result=a;if(typeof d.onload===\"function\"){d.onload({type:\"load\",target:d})}d.readyState=FileReader.DONE;if(typeof d.onloadend===\"function\"){d.onloadend({type:\"loadend\",target:d})}},function(a){var b;if(d.readyState===FileReader.DONE){return}d.error=a;if(typeof d.onerror===\"function\"){d.onerror({type:\"error\",target:d})}d.readyState=FileReader.DONE;if(typeof d.onloadend===\"function\"){d.onloadend({type:\"loadend\",target:d})}},\"File\",\"readAsText\",[this.fileName,c])};FileReader.prototype.readAsDataURL=function(a){this.fileName=\"\";if(typeof a.fullPath===\"undefined\"){this.fileName=a}else{this.fileName=a.fullPath}this.readyState=FileReader.LOADING;if(typeof this.onloadstart===\"function\"){this.onloadstart({type:\"loadstart\",target:this})}var b=this;PhoneGap.exec(function(a){var c;if(b.readyState===FileReader.DONE){return}b.result=a;if(typeof b.onload===\"function\"){b.onload({type:\"load\",target:b})}b.readyState=FileReader.DONE;if(typeof b.onloadend===\"function\"){b.onloadend({type:\"loadend\",target:b})}},function(a){var c;if(b.readyState===FileReader.DONE){return}b.error=a;if(typeof b.onerror===\"function\"){b.onerror({type:\"error\",target:b})}b.readyState=FileReader.DONE;if(typeof b.onloadend===\"function\"){b.onloadend({type:\"loadend\",target:b})}},\"File\",\"readAsDataURL\",[this.fileName])};FileReader.prototype.readAsBinaryString=function(a){this.fileName=a};FileReader.prototype.readAsArrayBuffer=function(a){this.fileName=a};var FileWriter=function(a){this.fileName=\"\";this.length=0;if(a){this.fileName=a.fullPath||a;this.length=a.size||0}this.position=0;this.readyState=0;this.result=null;this.error=null;this.onwritestart=null;this.onprogress=null;this.onwrite=null;this.onwriteend=null;this.onabort=null;this.onerror=null};FileWriter.INIT=0;FileWriter.WRITING=1;FileWriter.DONE=2;FileWriter.prototype.abort=function(){if(this.readyState===FileWriter.DONE||this.readyState===FileWriter.INIT){throw FileError.INVALID_STATE_ERR}var a=new FileError,b;a.code=a.ABORT_ERR;this.error=a;if(typeof this.onerror===\"function\"){this.onerror({type:\"error\",target:this})}if(typeof this.onabort===\"function\"){this.onabort({type:\"abort\",target:this})}this.readyState=FileWriter.DONE;if(typeof this.onwriteend==\"function\"){this.onwriteend({type:\"writeend\",target:this})}};FileWriter.prototype.write=function(a){if(this.readyState===FileWriter.WRITING){throw FileError.INVALID_STATE_ERR}this.readyState=FileWriter.WRITING;var b=this;if(typeof b.onwritestart===\"function\"){b.onwritestart({type:\"writestart\",target:b})}PhoneGap.exec(function(a){var c;if(b.readyState===FileWriter.DONE){return}b.position+=a;b.length=b.position;if(typeof b.onwrite===\"function\"){b.onwrite({type:\"write\",target:b})}b.readyState=FileWriter.DONE;if(typeof b.onwriteend===\"function\"){b.onwriteend({type:\"writeend\",target:b})}},function(a){var c;if(b.readyState===FileWriter.DONE){return}b.error=a;if(typeof b.onerror===\"function\"){b.onerror({type:\"error\",target:b})}b.readyState=FileWriter.DONE;if(typeof b.onwriteend===\"function\"){b.onwriteend({type:\"writeend\",target:b})}},\"File\",\"write\",[this.fileName,a,this.position])};FileWriter.prototype.seek=function(a){if(this.readyState===FileWriter.WRITING){throw FileError.INVALID_STATE_ERR}if(!a){return}if(a\x3C0){this.position=Math.max(a+this.length,0)}else if(a\x3Ethis.length){this.position=this.length}else{this.position=a}};FileWriter.prototype.truncate=function(a){if(this.readyState===FileWriter.WRITING){throw FileError.INVALID_STATE_ERR}this.readyState=FileWriter.WRITING;var b=this;if(typeof b.onwritestart===\"function\"){b.onwritestart({type:\"writestart\",target:this})}PhoneGap.exec(function(a){var c;if(b.readyState===FileWriter.DONE){return}b.length=a;b.position=Math.min(b.position,a);if(typeof b.onwrite===\"function\"){b.onwrite({type:\"write\",target:b})}b.readyState=FileWriter.DONE;if(typeof b.onwriteend===\"function\"){b.onwriteend({type:\"writeend\",target:b})}},function(a){var c;if(b.readyState===FileWriter.DONE){return}b.error=a;if(typeof b.onerror===\"function\"){b.onerror({type:\"error\",target:b})}b.readyState=FileWriter.DONE;if(typeof b.onwriteend===\"function\"){b.onwriteend({type:\"writeend\",target:b})}},\"File\",\"truncate\",[this.fileName,a])};var Metadata=function(){this.modificationTime=null};var Flags=function(a,b){this.create=a||false;this.exclusive=b||false};var FileSystem=function(){this.name=null;this.root=null};var DirectoryReader=function(a){this.fullPath=a||null};DirectoryReader.prototype.readEntries=function(a,b){PhoneGap.exec(a,b,\"File\",\"readEntries\",[this.fullPath])};var DirectoryEntry=function(){this.isFile=false;this.isDirectory=true;this.name=null;this.fullPath=null;this.filesystem=null};DirectoryEntry.prototype.copyTo=function(a,b,c,d){PhoneGap.exec(c,d,\"File\",\"copyTo\",[this.fullPath,a,b])};DirectoryEntry.prototype.getMetadata=function(a,b){PhoneGap.exec(a,b,\"File\",\"getMetadata\",[this.fullPath])};DirectoryEntry.prototype.getParent=function(a,b){PhoneGap.exec(a,b,\"File\",\"getParent\",[this.fullPath])};DirectoryEntry.prototype.moveTo=function(a,b,c,d){PhoneGap.exec(c,d,\"File\",\"moveTo\",[this.fullPath,a,b])};DirectoryEntry.prototype.remove=function(a,b){PhoneGap.exec(a,b,\"File\",\"remove\",[this.fullPath])};DirectoryEntry.prototype.toURI=function(a){return\"file:\x2F\x2F\"+this.fullPath};DirectoryEntry.prototype.createReader=function(a,b){return new DirectoryReader(this.fullPath)};DirectoryEntry.prototype.getDirectory=function(a,b,c,d){PhoneGap.exec(c,d,\"File\",\"getDirectory\",[this.fullPath,a,b])};DirectoryEntry.prototype.getFile=function(a,b,c,d){PhoneGap.exec(c,d,\"File\",\"getFile\",[this.fullPath,a,b])};DirectoryEntry.prototype.removeRecursively=function(a,b){PhoneGap.exec(a,b,\"File\",\"removeRecursively\",[this.fullPath])};var FileEntry=function(){this.isFile=true;this.isDirectory=false;this.name=null;this.fullPath=null;this.filesystem=null};FileEntry.prototype.copyTo=function(a,b,c,d){PhoneGap.exec(c,d,\"File\",\"copyTo\",[this.fullPath,a,b])};FileEntry.prototype.getMetadata=function(a,b){PhoneGap.exec(a,b,\"File\",\"getMetadata\",[this.fullPath])};FileEntry.prototype.getParent=function(a,b){PhoneGap.exec(a,b,\"File\",\"getParent\",[this.fullPath])};FileEntry.prototype.moveTo=function(a,b,c,d){PhoneGap.exec(c,d,\"File\",\"moveTo\",[this.fullPath,a,b])};FileEntry.prototype.remove=function(a,b){PhoneGap.exec(a,b,\"File\",\"remove\",[this.fullPath])};FileEntry.prototype.toURI=function(a){return\"file:\x2F\x2F\"+this.fullPath};FileEntry.prototype.createWriter=function(a,b){this.file(function(c){var d=new FileWriter(c);if(d.fileName===null||d.fileName===\"\"){if(typeof b==\"function\"){b({code:FileError.INVALID_STATE_ERR})}}if(typeof a==\"function\"){a(d)}},b)};FileEntry.prototype.file=function(a,b){PhoneGap.exec(a,b,\"File\",\"getFileMetadata\",[this.fullPath])};var LocalFileSystem=function(){};LocalFileSystem.TEMPORARY=0;LocalFileSystem.PERSISTENT=1;LocalFileSystem.RESOURCE=2;LocalFileSystem.APPLICATION=3;LocalFileSystem.prototype.requestFileSystem=function(a,b,c,d){if(a\x3C0||a\x3E3){if(typeof d==\"function\"){d({code:FileError.SYNTAX_ERR})}}else{PhoneGap.exec(c,d,\"File\",\"requestFileSystem\",[a,b])}};LocalFileSystem.prototype.resolveLocalFileSystemURI=function(a,b,c){PhoneGap.exec(b,c,\"File\",\"resolveLocalFileSystemURI\",[a])};LocalFileSystem.prototype._castFS=function(a){var b=null;b=new DirectoryEntry;b.isDirectory=a.message.root.isDirectory;b.isFile=a.message.root.isFile;b.name=a.message.root.name;b.fullPath=a.message.root.fullPath;a.message.root=b;return a};LocalFileSystem.prototype._castEntry=function(a){var b=null;if(a.message.isDirectory){console.log(\"This is a dir\");b=new DirectoryEntry}else if(a.message.isFile){console.log(\"This is a file\");b=new FileEntry}b.isDirectory=a.message.isDirectory;b.isFile=a.message.isFile;b.name=a.message.name;b.fullPath=a.message.fullPath;a.message=b;return a};LocalFileSystem.prototype._castEntries=function(a){var b=a.message;var c=[];for(var d=0;d\x3Cb.length;d++){c.push(window.localFileSystem._createEntry(b[d]))}a.message=c;return a};LocalFileSystem.prototype._createEntry=function(a){var b=null;if(a.isDirectory){console.log(\"This is a dir\");b=new DirectoryEntry}else if(a.isFile){console.log(\"This is a file\");b=new FileEntry}b.isDirectory=a.isDirectory;b.isFile=a.isFile;b.name=a.name;b.fullPath=a.fullPath;return b};LocalFileSystem.prototype._castDate=function(a){if(a.message.modificationTime){var b=new Date(a.message.modificationTime);a.message.modificationTime=b}else if(a.message.lastModifiedDate){var c=new File;c.size=a.message.size;c.type=a.message.type;c.name=a.message.name;c.fullPath=a.message.fullPath;c.lastModifiedDate=new Date(a.message.lastModifiedDate);a.message=c}return a};PhoneGap.addConstructor(function(){var a=new LocalFileSystem;if(typeof window.localFileSystem==\"undefined\")window.localFileSystem=a;if(typeof window.requestFileSystem==\"undefined\")window.requestFileSystem=a.requestFileSystem;if(typeof window.resolveLocalFileSystemURI==\"undefined\")window.resolveLocalFileSystemURI=a.resolveLocalFileSystemURI})}if(!PhoneGap.hasResource(\"filetransfer\")){PhoneGap.addResource(\"filetransfer\");var FileTransfer=function(){};var FileUploadResult=function(){this.bytesSent=0;this.responseCode=null;this.response=null};var FileTransferError=function(){this.code=null};FileTransferError.FILE_NOT_FOUND_ERR=1;FileTransferError.INVALID_URL_ERR=2;FileTransferError.CONNECTION_ERR=3;FileTransfer.prototype.upload=function(a,b,c,d,e,f){var g=null;var h=null;var i=null;var j=null;var k=true;if(e){g=e.fileKey;h=e.fileName;i=e.mimeType;if(e.chunkedMode!=null||typeof e.chunkedMode!=\"undefined\"){k=e.chunkedMode}if(e.params){j=e.params}else{j={}}}PhoneGap.exec(c,d,\"FileTransfer\",\"upload\",[a,b,g,h,i,j,f,k])};var FileUploadOptions=function(a,b,c,d){this.fileKey=a||null;this.fileName=b||null;this.mimeType=c||null;this.params=d||null};PhoneGap.addConstructor(function(){if(typeof navigator.fileTransfer===\"undefined\"){navigator.fileTransfer=new FileTransfer}})}if(!PhoneGap.hasResource(\"geolocation\")){PhoneGap.addResource(\"geolocation\");var Geolocation=function(){this.lastPosition=null;this.listeners={}};var PositionError=function(a,b){this.code=a;this.message=b};PositionError.PERMISSION_DENIED=1;PositionError.POSITION_UNAVAILABLE=2;PositionError.TIMEOUT=3;Geolocation.prototype.getCurrentPosition=function(a,b,c){if(navigator._geo.listeners.global){console.log(\"Geolocation Error: Still waiting for previous getCurrentPosition() request.\");try{b(new PositionError(PositionError.TIMEOUT,\"Geolocation Error: Still waiting for previous getCurrentPosition() request.\"))}catch(d){}return}var e=1e4;var f=false;var g=1e4;if(typeof c!==\"undefined\"){if(typeof c.maximumAge!==\"undefined\"){e=c.maximumAge}if(typeof c.enableHighAccuracy!==\"undefined\"){f=c.enableHighAccuracy}if(typeof c.timeout!==\"undefined\"){g=c.timeout}}navigator._geo.listeners.global={success:a,fail:b};PhoneGap.exec(null,null,\"Geolocation\",\"getCurrentLocation\",[f,g,e])};Geolocation.prototype.watchPosition=function(a,b,c){var d=1e4;var e=false;var f=1e4;if(typeof c!==\"undefined\"){if(typeof c.frequency!==\"undefined\"){d=c.frequency}if(typeof c.maximumAge!==\"undefined\"){d=c.maximumAge}if(typeof c.enableHighAccuracy!==\"undefined\"){e=c.enableHighAccuracy}if(typeof c.timeout!==\"undefined\"){f=c.timeout}}var g=PhoneGap.createUUID();navigator._geo.listeners[g]={success:a,fail:b};PhoneGap.exec(null,null,\"Geolocation\",\"start\",[g,e,f,d]);return g};Geolocation.prototype.success=function(a,b,c,d,e,f,g,h){var i=new Coordinates(b,c,d,e,f,g);var j=new Position(i,h);try{if(b===\"undefined\"||c===\"undefined\"){navigator._geo.listeners[a].fail(new PositionError(PositionError.POSITION_UNAVAILABLE,\"Lat\x2FLng are undefined.\"))}else{navigator._geo.lastPosition=j;navigator._geo.listeners[a].success(j)}}catch(k){console.log(\"Geolocation Error: Error calling success callback function.\")}if(a===\"global\"){delete navigator._geo.listeners.global}};Geolocation.prototype.fail=function(a,b,c){try{navigator._geo.listeners[a].fail(new PositionError(b,c))}catch(d){console.log(\"Geolocation Error: Error calling error callback function.\")}};Geolocation.prototype.clearWatch=function(a){PhoneGap.exec(null,null,\"Geolocation\",\"stop\",[a]);delete navigator._geo.listeners[a]};Geolocation.usingPhoneGap=false;Geolocation.usePhoneGap=function(){if(Geolocation.usingPhoneGap){return}Geolocation.usingPhoneGap=true;navigator.geolocation.setLocation=navigator._geo.setLocation;navigator.geolocation.getCurrentPosition=navigator._geo.getCurrentPosition;navigator.geolocation.watchPosition=navigator._geo.watchPosition;navigator.geolocation.clearWatch=navigator._geo.clearWatch;navigator.geolocation.start=navigator._geo.start;navigator.geolocation.stop=navigator._geo.stop};PhoneGap.addConstructor(function(){navigator._geo=new Geolocation;if(typeof navigator.geolocation===\"undefined\"){navigator.geolocation=navigator._geo;Geolocation.usingPhoneGap=true}})}if(!PhoneGap.hasResource(\"media\")){PhoneGap.addResource(\"media\");var Media=function(a,b,c,d,e){if(b\&\&typeof b!==\"function\"){console.log(\"Media Error: successCallback is not a function\");return}if(c\&\&typeof c!==\"function\"){console.log(\"Media Error: errorCallback is not a function\");return}if(d\&\&typeof d!==\"function\"){console.log(\"Media Error: statusCallback is not a function\");return}if(e\&\&typeof e!==\"function\"){console.log(\"Media Error: positionCallback is not a function\");return}this.id=PhoneGap.createUUID();PhoneGap.mediaObjects[this.id]=this;this.src=a;this.successCallback=b;this.errorCallback=c;this.statusCallback=d;this.positionCallback=e;this._duration=-1;this._position=-1};Media.MEDIA_STATE=1;Media.MEDIA_DURATION=2;Media.MEDIA_POSITION=3;Media.MEDIA_ERROR=9;Media.MEDIA_NONE=0;Media.MEDIA_STARTING=1;Media.MEDIA_RUNNING=2;Media.MEDIA_PAUSED=3;Media.MEDIA_STOPPED=4;Media.MEDIA_MSG=[\"None\",\"Starting\",\"Running\",\"Paused\",\"Stopped\"];var MediaError=function(){this.code=null;this.message=\"\"};MediaError.MEDIA_ERR_NONE_ACTIVE=0;MediaError.MEDIA_ERR_ABORTED=1;MediaError.MEDIA_ERR_NETWORK=2;MediaError.MEDIA_ERR_DECODE=3;MediaError.MEDIA_ERR_NONE_SUPPORTED=4;Media.prototype.play=function(){PhoneGap.exec(null,null,\"Media\",\"startPlayingAudio\",[this.id,this.src])};Media.prototype.stop=function(){return PhoneGap.exec(null,null,\"Media\",\"stopPlayingAudio\",[this.id])};Media.prototype.seekTo=function(a){PhoneGap.exec(null,null,\"Media\",\"seekToAudio\",[this.id,a])};Media.prototype.pause=function(){PhoneGap.exec(null,null,\"Media\",\"pausePlayingAudio\",[this.id])};Media.prototype.getDuration=function(){return this._duration};Media.prototype.getCurrentPosition=function(a,b){PhoneGap.exec(a,b,\"Media\",\"getCurrentPositionAudio\",[this.id])};Media.prototype.startRecord=function(){PhoneGap.exec(null,null,\"Media\",\"startRecordingAudio\",[this.id,this.src])};Media.prototype.stopRecord=function(){PhoneGap.exec(null,null,\"Media\",\"stopRecordingAudio\",[this.id])};Media.prototype.release=function(){PhoneGap.exec(null,null,\"Media\",\"release\",[this.id])};Media.prototype.setVolume=function(a){PhoneGap.exec(null,null,\"Media\",\"setVolume\",[this.id,a])};PhoneGap.mediaObjects={};PhoneGap.Media=function(){};PhoneGap.Media.getMediaObject=function(a){return PhoneGap.mediaObjects[a]};PhoneGap.Media.onStatus=function(a,b,c){var d=PhoneGap.mediaObjects[a];if(b===Media.MEDIA_STATE){if(c===Media.MEDIA_STOPPED){if(d.successCallback){d.successCallback()}}if(d.statusCallback){d.statusCallback(c)}}else if(b===Media.MEDIA_DURATION){d._duration=c}else if(b===Media.MEDIA_ERROR){if(d.errorCallback){d.errorCallback({code:c})}}else if(b==Media.MEDIA_POSITION){d._position=c}}}if(!PhoneGap.hasResource(\"network\")){PhoneGap.addResource(\"network\");var Connection=function(){this.type=null;this._firstRun=true;this._timer=null;this.timeout=500;var a=this;this.getInfo(function(b){if(b==\"none\"){a._timer=setTimeout(function(){a.type=b;PhoneGap.fireDocumentEvent(\"offline\");a._timer=null},a.timeout)}else{if(a._timer!=null){clearTimeout(a._timer);a._timer=null}a.type=b;PhoneGap.fireDocumentEvent(\"online\")}if(a._firstRun){a._firstRun=false;PhoneGap.onPhoneGapConnectionReady.fire()}},function(b){if(a._firstRun){a._firstRun=false;PhoneGap.onPhoneGapConnectionReady.fire()}console.log(\"Error initializing Network Connection: \"+b)})};Connection.UNKNOWN=\"unknown\";Connection.ETHERNET=\"ethernet\";Connection.WIFI=\"wifi\";Connection.CELL_2G=\"2g\";Connection.CELL_3G=\"3g\";Connection.CELL_4G=\"4g\";Connection.NONE=\"none\";Connection.prototype.getInfo=function(a,b){PhoneGap.exec(a,b,\"Network Status\",\"getConnectionInfo\",[])};PhoneGap.addConstructor(function(){if(typeof navigator.network===\"undefined\"){navigator.network=new Object}if(typeof navigator.network.connection===\"undefined\"){navigator.network.connection=new Connection}})}if(!PhoneGap.hasResource(\"notification\")){PhoneGap.addResource(\"notification\");var Notification=function(){};Notification.prototype.alert=function(a,b,c,d){var e=c||\"Alert\";var f=d||\"OK\";PhoneGap.exec(b,null,\"Notification\",\"alert\",[a,e,f])};Notification.prototype.confirm=function(a,b,c,d){var e=c||\"Confirm\";var f=d||\"OK,Cancel\";PhoneGap.exec(b,null,\"Notification\",\"confirm\",[a,e,f])};Notification.prototype.activityStart=function(){PhoneGap.exec(null,null,\"Notification\",\"activityStart\",[\"Busy\",\"Please wait...\"])};Notification.prototype.activityStop=function(){PhoneGap.exec(null,null,\"Notification\",\"activityStop\",[])};Notification.prototype.progressStart=function(a,b){PhoneGap.exec(null,null,\"Notification\",\"progressStart\",[a,b])};Notification.prototype.progressValue=function(a){PhoneGap.exec(null,null,\"Notification\",\"progressValue\",[a])};Notification.prototype.progressStop=function(){PhoneGap.exec(null,null,\"Notification\",\"progressStop\",[])};Notification.prototype.blink=function(a,b){};Notification.prototype.vibrate=function(a){PhoneGap.exec(null,null,\"Notification\",\"vibrate\",[a])};Notification.prototype.beep=function(a){PhoneGap.exec(null,null,\"Notification\",\"beep\",[a])};PhoneGap.addConstructor(function(){if(typeof navigator.notification===\"undefined\"){navigator.notification=new Notification}})}if(!PhoneGap.hasResource(\"position\")){PhoneGap.addResource(\"position\");var Position=function(a,b){this.coords=a;this.timestamp=b!==\"undefined\"?b:(new Date).getTime()};var Coordinates=function(a,b,c,d,e,f,g){this.latitude=a;this.longitude=b;this.accuracy=d;this.altitude=c;this.heading=e;this.speed=f;this.altitudeAccuracy=g!==\"undefined\"?g:null};var PositionOptions=function(){this.enableHighAccuracy=true;this.timeout=1e4};var PositionError=function(){this.code=null;this.message=\"\"};PositionError.UNKNOWN_ERROR=0;PositionError.PERMISSION_DENIED=1;PositionError.POSITION_UNAVAILABLE=2;PositionError.TIMEOUT=3}if(!PhoneGap.hasResource(\"storage\")){PhoneGap.addResource(\"storage\");var DroidDB_Rows=function(){this.resultSet=[];this.length=0};DroidDB_Rows.prototype.item=function(a){return this.resultSet[a]};var DroidDB_Result=function(){this.rows=new DroidDB_Rows};var DroidDB=function(){this.queryQueue={}};DroidDB.prototype.completeQuery=function(a,b){var c=this.queryQueue[a];if(c){try{delete this.queryQueue[a];var d=c.tx;if(d\&\&d.queryList[a]){var e=new DroidDB_Result;e.rows.resultSet=b;e.rows.length=b.length;try{if(typeof c.successCallback===\"function\"){c.successCallback(c.tx,e)}}catch(f){console.log(\"executeSql error calling user success callback: \"+f)}d.queryComplete(a)}}catch(g){console.log(\"executeSql error: \"+g)}}};DroidDB.prototype.fail=function(a,b){var c=this.queryQueue[b];if(c){try{delete this.queryQueue[b];var d=c.tx;if(d\&\&d.queryList[b]){d.queryList={};try{if(typeof c.errorCallback===\"function\"){c.errorCallback(c.tx,a)}}catch(e){console.log(\"executeSql error calling user error callback: \"+e)}d.queryFailed(b,a)}}catch(f){console.log(\"executeSql error: \"+f)}}};var DroidDB_Query=function(a){this.id=PhoneGap.createUUID();droiddb.queryQueue[this.id]=this;this.resultSet=[];this.tx=a;this.tx.queryList[this.id]=this;this.successCallback=null;this.errorCallback=null};var DroidDB_Tx=function(){this.id=PhoneGap.createUUID();this.successCallback=null;this.errorCallback=null;this.queryList={}};DroidDB_Tx.prototype.queryComplete=function(a){delete this.queryList[a];if(this.successCallback){var b=0;var c;for(c in this.queryList){if(this.queryList.hasOwnProperty(c)){b++}}if(b===0){try{this.successCallback()}catch(d){console.log(\"Transaction error calling user success callback: \"+d)}}}};DroidDB_Tx.prototype.queryFailed=function(a,b){this.queryList={};if(this.errorCallback){try{this.errorCallback(b)}catch(c){console.log(\"Transaction error calling user error callback: \"+c)}}};DroidDB_Tx.prototype.executeSql=function(a,b,c,d){if(typeof b===\"undefined\"){b=[]}var e=new DroidDB_Query(this);droiddb.queryQueue[e.id]=e;e.successCallback=c;e.errorCallback=d;PhoneGap.exec(null,null,\"Storage\",\"executeSql\",[a,b,e.id])};var DatabaseShell=function(){};DatabaseShell.prototype.transaction=function(a,b,c){var d=new DroidDB_Tx;d.successCallback=c;d.errorCallback=b;try{a(d)}catch(e){console.log(\"Transaction error: \"+e);if(d.errorCallback){try{d.errorCallback(e)}catch(f){console.log(\"Transaction error calling user error callback: \"+e)}}}};var DroidDB_openDatabase=function(a,b,c,d){PhoneGap.exec(null,null,\"Storage\",\"openDatabase\",[a,b,c,d]);var e=new DatabaseShell;return e};var CupcakeLocalStorage=function(){try{this.db=openDatabase(\"localStorage\",\"1.0\",\"localStorage\",2621440);var a={};this.length=0;function b(a){this.length=a;localStorage.length=a}this.db.transaction(function(c){var d;c.executeSql(\"CREATE TABLE IF NOT EXISTS storage (id NVARCHAR(40) PRIMARY KEY, body NVARCHAR(255))\");c.executeSql(\"SELECT * FROM storage\",[],function(c,d){for(var e=0;e\x3Cd.rows.length;e++){a[d.rows.item(e)[\"id\"]]=d.rows.item(e)[\"body\"]}b(d.rows.length);PhoneGap.initializationComplete(\"cupcakeStorage\")})},function(a){alert(a.message)});this.setItem=function(b,c){if(typeof a[b]==\"undefined\"){this.length++}a[b]=c;this.db.transaction(function(a){a.executeSql(\"CREATE TABLE IF NOT EXISTS storage (id NVARCHAR(40) PRIMARY KEY, body NVARCHAR(255))\");a.executeSql(\"REPLACE INTO storage (id, body) values(?,?)\",[b,c])})};this.getItem=function(b){return a[b]};this.removeItem=function(b){delete a[b];this.length--;this.db.transaction(function(a){a.executeSql(\"CREATE TABLE IF NOT EXISTS storage (id NVARCHAR(40) PRIMARY KEY, body NVARCHAR(255))\");a.executeSql(\"DELETE FROM storage where id=?\",[b])})};this.clear=function(){a={};this.length=0;this.db.transaction(function(a){a.executeSql(\"CREATE TABLE IF NOT EXISTS storage (id NVARCHAR(40) PRIMARY KEY, body NVARCHAR(255))\");a.executeSql(\"DELETE FROM storage\",[])})};this.key=function(b){var c=0;for(var d in a){if(c==b){return d}else{c++}}return null}}catch(c){alert(\"Database error \"+c+\".\");return}};PhoneGap.addConstructor(function(){var a=function(){navigator.openDatabase=window.openDatabase=DroidDB_openDatabase;window.droiddb=new DroidDB};if(typeof window.openDatabase===\"undefined\"){a()}else{window.openDatabase_orig=window.openDatabase;window.openDatabase=function(b,c,d,e){var f=null;try{f=window.openDatabase_orig(b,c,d,e)}catch(g){f=null}if(f==null){a();return DroidDB_openDatabase(b,c,d,e)}else{return f}}}if(typeof window.localStorage===\"undefined\"){navigator.localStorage=window.localStorage=new CupcakeLocalStorage;PhoneGap.waitForInitialization(\"cupcakeStorage\")}})}if(!PhoneGap.hasResource(\"deviceorientation\")){PhoneGap.addResource(\"deviceorientation\");function DeviceOrientation(){this.successCallback=function(){};this.failCallback=function(){}}DeviceOrientation.prototype.setOrientation=function(a,b,c){this.successCallback=b;this.failCallback=c;if(typeof PhoneGap!=\"undefined\"){PhoneGap.exec(b,c,\"DeviceOrientation\",\"setOrientation\",[a])}};DeviceOrientation.prototype.success=function(a){if(typeof this.successCallback==\"function\"){this.successCallback({orientation:a})}};DeviceOrientation.prototype.fail=function(a){if(typeof this.failCallback==\"function\"){this.failCallback(a)}};PhoneGap.addConstructor(function(){if(typeof navigator.deviceOrientation==\"undefined\"){navigator.deviceOrientation=new DeviceOrientation}})}if(!PhoneGap.hasResource(\"flurry\")){PhoneGap.addResource(\"flurry\");function Flurry(){}Flurry.prototype.logEvent=function(a,b){var c=JSON.stringify(b);PhoneGap.exec(null,null,\"Analytics\",\"logEvent\",[a,c])};PhoneGap.addConstructor(function(){if(typeof window.flurry===\"undefined\"){window.flurry=new Flurry}})}if(!PhoneGap.hasResource(\"pushnotification\")){PhoneGap.addResource(\"pushnotification\");function PushNotification(){this.registerCallback=null}PushNotification.prototype.register=function(a,b){this.registerCallback=a;PhoneGap.exec(a,b,\"PushNotificationPlugin\",\"registerCallback\",[])};PushNotification.prototype.registerSuccess=function(a){if(typeof this.registerCallback==\"function\"){this.registerCallback(a)}};PushNotification.prototype.init=function(a,b){return PhoneGap.exec(a,b,\"PushNotificationPlugin\",\"init\",[])};PushNotification.prototype.notificationCallback=function(a){var b=window.JSON.parse(a);if(typeof $fh.receive_push===\"function\"){$fh.receive_push(b)}};PhoneGap.addConstructor(function(){if(typeof navigator.pushNotification==\"undefined\")navigator.pushNotification=new PushNotification})}if(!PhoneGap.hasResource(\"sms\")){PhoneGap.addResource(\"sms\");function Sms(){}Sms.prototype.send=function(a,b,c,d){PhoneGap.exec(a,b,\"Sms\",\"send\",[c,d])};PhoneGap.addConstructor(function(){if(typeof navigator.sms===\"undefined\"){navigator.sms=new Sms}})}var dummysuccess=function(a){};var dummyerror=function(a){};if(!PhoneGap.hasResource(\"stream\")){PhoneGap.addResource(\"stream\");function Audio(){this.successCallback={};this.errorCallback={}}Audio.prototype.action=function(a,b,c){this.params=a;switch(a.act){case\"play\":this.successCallback.play=b;this.errorCallback.play=c;PhoneGap.exec(dummysuccess,dummyerror,\"Stream\",\"play\",[a.path]);break;case\"pause\":this.successCallback.pause=b;this.errorCallback.pause=c;PhoneGap.exec(dummysuccess,dummyerror,\"Stream\",\"pause\",[]);break;case\"stop\":this.successCallback.stop=b;this.errorCallback.stop=c;PhoneGap.exec(dummysuccess,dummyerror,\"Stream\",\"stop\",[]);break;case\"getvolume\":this.successCallback.getvolume=b;this.errorCallback.getvolume=c;PhoneGap.exec(dummysuccess,dummyerror,\"Stream\",\"getvolume\",[]);break;case\"setvolume\":this.successCallback.setvolume=b;this.errorCallback.setvolume=c;PhoneGap.exec(dummysuccess,dummyerror,\"Stream\",\"setvolume\",[a.level]);break;case\"getbufferprogress\":this.successCallback.getbufferprogress=b;this.errorCallback.getbufferprogress=c;PhoneGap.exec(dummysuccess,dummyerror,\"Stream\",\"getbufferprogress\",[]);break;case\"seek\":this.successCallback.seek=b;this.errorCallback.seek=c;PhoneGap.exec(dummysuccess,dummyerror,\"Stream\",\"seek\",[a.seekPosition]);break;case\"getcurrentposition\":this.successCallback.getcurrentposition=b;this.errorCallback.getcurrentposition=c;PhoneGap.exec(dummysuccess,dummyerror,\"Stream\",\"getcurrentposition\",[]);break;case\"resume\":this.successCallback.resume=b;this.errorCallback.resume=c;PhoneGap.exec(dummysuccess,dummyerror,\"Stream\",\"resume\",[]);break;default:c(\"Data_Act: No Action defined\");break}};Audio.prototype.success=function(a,b){if(this.successCallback[a]){this.successCallback[a](b)}};Audio.prototype.failure=function(a,b){if(this.errorCallback[a]){this.errorCallback[a](b)}};var audio_init_counter=0;PhoneGap.addConstructor(function(){console.log(\"Navigator audio inited ::\"+audio_init_counter++);if(typeof navigator.audio==\"undefined\")navigator.audio=new Audio})}if(!PhoneGap.hasResource(\"webview\")){PhoneGap.addResource(\"webview\");function WebView(){this.opened=false}WebView.prototype.action=function(a,b,c){var d=function(a){a[\"title\"]?PhoneGap.exec(dummysuccess,dummyerror,\"ViewCtrl\",\"display\",[a.url,a.title]):PhoneGap.exec(dummysuccess,dummyerror,\"ViewCtrl\",\"display\",[a.url,\"undefined\"])};if(!(\"act\"in a)||a.act===\"open\"){this.successCallback=b;this.errorCallback=c;a[\"url\"]?d(a):c(\"Data_Act: No Action defined\")}else{if(a.act===\"close\"\&\&this.opened){this.opened=false;PhoneGap.exec(dummysuccess,dummyerror,\"ViewCtrl\",\"close\",[])}}};WebView.prototype.success=function(a){if(a===\"closed\"){this.opened=false}else{this.opened=true}this.successCallback(a)};WebView.prototype.failure=function(a){this.errorCallback(a)};PhoneGap.addConstructor(function(){if(typeof navigator.webview==\"undefined\")navigator.webview=new WebView})}$fh._readyCallbacks=[];$fh._readyState=false;$fh.__dest__.ready=function(a,b,c){if($fh._readyState){b()}else{$fh._readyCallbacks.push(b)}};$fh.__dest__.setUUID=function(a,b,c){};document.addEventListener(\"deviceready\",function(){$fh._readyState=true;document.removeEventListener(\"deviceready\",arguments.callee,false);while($fh._readyCallbacks.length\x3E0){var a=$fh._readyCallbacks.shift();a()}});$fh.__dest__.env=function(a,b,c){b({uuid:function(){return navigator.device?navigator.device.uuid:\"\"}()+\"\",density:function(){return navigator.device?navigator.device.density:1}()})};$fh.__dest__.handlers=function(a,b,c){if(!a.type){c(\"hanlders_no_type\");return}var d={back:function(){navigator.device.overrideBackButton();var a=function(){var a=b();if(a){navigator.device.exitApp()}};document.addEventListener(\"backbutton\",a,false)},menu:function(){var a=function(){b()};document.addEventListener(\"menubutton\",a,false)}};d[a.type]?d[a.type]():c(\"hanlders_invalid_type\")};$fh.__dest__.log=function(a,b,c){console.log(a.message)};$fh.__dest__._geoWatcher=undefined;$fh.__dest__.geo=function(a,b,c){if(!a.act||a.act==\"register\"){if($fh.__dest__._geoWatcher){c(\"geo_inuse\",{},a);return}if(a.interval==0){var d=navigator._geo.watchPosition(function(a){var c=a.coords;var e={lon:c.longitude,lat:c.latitude,alt:c.altitude,acc:c.accuracy,head:c.heading,speed:c.speed,when:a.timestamp};navigator._geo.clearWatch(d);b(e)},function(){c(\"error_geo\")},{frequency:1e3})}if(a.interval\x3E0){$fh.__dest__._geoWatcher=navigator._geo.watchPosition(function(a){var c=a.coords;var d={lon:c.longitude,lat:c.latitude,alt:c.altitude,acc:c.accuracy,head:c.heading,speed:c.speed,when:a.timestamp};b(d)},function(){c(\"error_geo\")},{frequency:a.interval})}}else if(a.act==\"unregister\"){if($fh.__dest__._geoWatcher){navigator._geo.clearWatch($fh.__dest__._geoWatcher);$fh.__dest__._geoWatcher=undefined}b()}else{c(\"geo_badact\",{},a)}};$fh.__dest__.contacts=function(a,b,c){var d=[\"name\",\"nickname\",\"phoneNumbers\",\"emails\",\"addresses\"];var e={list:function(){navigator.contacts.find([\"*\"],function(a){console.log(JSON.stringify(a));var c=g(a);b({list:c})},function(){c(\"contacts_list_error\",{},a)},{filter:\"\",multiple:true})},find:function(){if(!a.by){c(\"contacts_findbynull\",{},a);return}var e=[\"*\"];if(a.by\&\&typeof a.by==\"string\"){e=d;e.push(a.by)}navigator.contacts.find(e,function(a){var c=g(a);b({list:c})},function(){c(\"contacts_error\",{},a)},{filter:a.val,multiple:true})},add:function(){var d={};if(a.gui){navigator.contacts.insert(function(a){var c=f(a);b(c)},function(b){c(b,{},a)})}else{var e=a.contact;if(a.contact){var g=[];if(typeof a.contact.phone===\"object\"){for(var h in a.contact.phone){g.push({type:h,value:a.contact.phone[h]})}}else if(typeof a.contact.phone===\"string\"){g.push({type:\"mobile\",value:a.contact.phone})}if(g.length\x3E0){e[\"phoneNumbers\"]=g}if(a.contact.first||a.contact.last){e[\"name\"]={givenName:a.contact.first,familyName:a.contact.last}}}var i=navigator.contacts.create(e);i.save(function(a){var c=f(a);b(c)},function(b){c(b,{},a)})}},remove:function(){if(!a.contact){return function(){c(\"no_contact\",{},a)}}if(!a.contact.id){return function(){c(\"no_contactId\",{},a)}}var d=navigator.contacts.create({id:a.contact.id});d.remove(function(){b()},function(a){c(a)})},choose:function(){navigator.contacts.choose(function(a){var c=g([a]);b({list:c})},function(){c(\"contacts_choose_error\",{},a)})}};var f=function(a){return{first:a.name.givenName,last:a.name.familyName,name:null==a.nickname?a.name.formatted:a.nickname,addr:h(a.addresses),phone:h(a.phoneNumbers),email:h(a.emails),id:a.id}};var g=function(a){var b=[];for(var c=0,d=a.length;c\x3Cd;c++){var e=a[c];b.push(f(e))}return b};var h=function(a){var b={};if(null!=a){for(var c=0;c\x3Ca.length;c++){var d=a[c];b[d.type]=d.value}}return b};var i=e[a.act];if(i){i()}else{c(\"contacts_badact\",{},a)}};$fh.__dest__._accWatcher=undefined;$fh.__dest__.acc=function(a,b,c){if(!a.act||a.act==\"register\"){if($fh.__dest__._accWatcher){c(\"acc_inuse\",{},a);return}if(a.interval==0){var d=navigator.accelerometer.watchAcceleration(function(a){var c={x:a.x,y:a.y,z:a.z,when:a.timestamp};b(c);navigator.accelerometer.clearWatch(d)},function(){c(\"error_acc\",{},a)},{frequency:1e3})}if(a.interval\x3E0){$fh.__dest__._accWatcher=navigator.accelerometer.watchAcceleration(function(a){var c={x:a.x,y:a.y,z:a.z,when:a.timestamp};b(c)},function(){c(\"error_acc\",{},a)},{frequency:a.interval})}}else if(a.act==\"unregister\"){if($fh.__dest__._accWatcher){navigator.accelerometer.clearWatch($fh.__dest__._accWatcher);$fh.__dest__._accWatcher=undefined}b()}else{c(\"acc_badact\",{},a)}};$fh.__dest__.notify=function(a,b,c){var d={vibrate:function(){navigator.notification.vibrate(1e3)},beep:function(){navigator.notification.beep(2)}};var e=d[a.type];if(e){e()}else{c(\"notify_badact\",{},a)}};$fh.__dest__.cam=function(a,b,c){if(a.act\&\&a.act!=\"picture\"){c(\"cam_nosupport\",{},a);return}var d=1;if(a.source\&\&a.source==\"photo\"){d=0}var e=0;if(a.uri){e=1}var f={sourceType:d,destinationType:e};navigator.camera.getPicture(function(c){if(a.uri){b({uri:c})}else{var d={format:\"jpg\",b64:c};b(d)}},function(){c(\"cam_error\",{},a)},f)};$fh.__dest__.send=function(a,b,c){if(a.type==\"email\"){var d=\"mailto:\"+a.to+\"?cc=\"+(a.cc?a.cc:\" \")+\"\&bcc=\"+(a.bcc?a.bcc:\" \")+\"\&subject=\"+(a.subject?a.subject:\"\")+\"\&body=\"+(a.body?encodeURI(a.body):\"\");document.location=d}else if(a.type==\"sms\"){if(typeof a.background!=\"undefined\"\&\&a.background){if(typeof navigator.sms!=\"undefined\"){navigator.sms.send(function(){b()},function(b){c(b,{},a)},a.to,a.body)}else{c(\"send_sms_nobackground\",{},a)}}else{var d=\"sms:\"+a.to;document.location=d}}else{c(\"send_nosupport\",{},a);return}};$fh.__dest__.audio=function(a,b,c){navigator.audio.action(a,b,c)};$fh.__dest__.webview=function(a,b,c){navigator.webview.action(a,b,c)};$fh.__dest__.ori=function(a,b,c){if(typeof a.act==\"undefined\"||a.act==\"listen\"){window.addEventListener(\"orientationchange\",function(a){b(window.orientation)},false)}else if(a.act==\"set\"){if(!a.value){c(\"ori_no_value\");return}navigator.deviceOrientation.setOrientation(a.value,function(a){b(a)},function(a){c(a)})}else{c(\"ori_badact\")}};$fh.__dest__.file=function(a,b,c){var d=[\"file_notfound\",\"file_invalid_url\",\"file_connection_err\",\"file_server_err\"];var e={upload:function(){if(!a.filepath){c(\"file_nofilepath\");return}if(!a.server){c(\"file_noserver\");return}var e={};if(a.filekey){e.fileKey=a.filekey}if(a.filename){e.fileName=a.filename}if(a.mime){e.mimeType=a.mime}if(a.params){e.params=a.params}var f=false;if(a.debug){f=true}navigator.fileTransfer.upload(a.filepath,a.server,function(a){b({status:a.responseCode,res:a.response,size:a.bytesSent})},function(a){var b=\"file_unknown\";if(1\x3C=a.code\x3C=4){b=d[a.code-1]}c(b)},e,f)}};var f=e[a.act];if(f){f()}else{c(\"file_badact\")}};$fh.__dest__.push=function(a,b,c){var d={register:function(){navigator.pushNotification.register(function(a){b({apid:a})},function(){})},receive:function(){navigator.pushNotification.init(function(){},function(){});$fh.receive_push=function(a){var c={message:a.msg,extras:a.payload};b(c)}}};d[a.act]?d[a.act]():c(\"push_badact\")};document.addEventListener(\"deviceready\",function(){$fh._readyState=true;document.removeEventListener(\"deviceready\",arguments.callee,false);while($fh._readyCallbacks.length\x3E0){var a=$fh._readyCallbacks.shift();a()}})</script>"
	};


http.ServerResponse.prototype.writeError = function(code, desc) {
	this.writeHead(code, {
		"Content-Type": mimeTypes.txt
	});
	this.end(desc + "\n");
}


function fileExists(uri, cb) {
	var lookupIndex = 0;

	(function checkPath(filename) {
		filename = path.join(process.cwd(), filename);

		path.exists(filename, function(exists) {
			if(!exists) {
				if(lookupIndex >= lookupDirs.length) {
					cb && cb(false);
				}
				else {
					checkPath(uri.replace("client/default", lookupDirs[lookupIndex++]));
				}
			}
			else {
				cb && cb(true, filename);
			}
		});	
	})(uri);
}


function validateArgs(args) {
	for(var i in defaultArgs) {
		var defaultArg = defaultArgs[i];
		if(args[i] === undefined) {

			if(defaultArg.required) {
				if(!defaultArg.val) {
					throw new Error("Missing '" + i + "' parameter")
				}
				else if(defaultArg.val) {
					args[i] = defaultArg.val;
				}
			}
		}
	}
}

function server(args, cb) {
	try{
		var argObj = common.parseArgs(args);
		validateArgs(argObj);
	} catch (x) {
		return cb("Error processing args: " + x + "\nUsage: " + server.usage);
	}


	if(argObj.package) {
		lookupDirs.push("client/" + argObj.package);
	}

	var domain = argObj.domain + argObj.baseDomain,
		browserScript = '<script src="https://' + domain + '/static/pec/script/studio/155-scripts.js"></script>',
		initialiseScript = 
		'<script>' +
		'$fhclient = $fh.init({' +
			'appMode:"debug",' +
			'checkDeliveryScheme:true,' +
			'debugCloudType:"fh",' +
			'debugCloudUrl: "https://' + domain + '",' +
			'deliveryScheme:"https://",' +
			'destination: {' +
				'inline:false,' +
				'name:"studio"' +
			'},' +
			'domain: "' + argObj.domain + '",' +
			'host: "' + domain + '",' +
			'nameserver:"https://ainm.feedhenry.com",' +
			'releaseCloudType:"fh",' +
			'releaseCloudUrl:"https://' + domain + '",' +
			'swagger_view:"Sju8tJFwM7kox_S1rr1wZ2PS",' +
			'urltag:"",' +
			'useSecureConnection:true,' +
			'user:{' +
				'id:"YqxcBngHv4nt3j1VstTjQj0X",' +
				'role:"sub"' +
			'},' +
			'widget:{' +
				'guid:"' + argObj.app + '",' +
				'inline:false,' +
				'instance: "' + argObj.app +'",' +
				'version:328' +
			'}' +
		'});' +
		'</script>';

	http.createServer(function handleRequest(request, response) {

		var requestParams = url.parse(request.url, true),
			uri = requestParams.pathname;

		if(request.method === "POST") {
			var proxyReq = https.request({
				path: uri,
				method: request.method,
				host: domain,
				headers: request.headers
			}, function(proxyRes) {
				response.writeHead(proxyRes.statusCode, proxyRes.headers);

				proxyRes.on("data", function(chunk) {
					response.write(chunk);
				});
				proxyRes.on("end", function() {
					response.end();
				});
			});

			request.on("data", function(chunk) {
				proxyReq.write(chunk);
			});

			request.on("end", function() {
				proxyReq.end();
			});
		}
		else {
			fileExists(uri, function(exists, filename) {
				if(!exists) {
					return response.writeError(404, "Not Found");
				}

				if (fs.statSync(filename).isDirectory()) 
					filename += '/index.html';

				fs.readFile(filename, "binary", function(err, file) {
					if(err) {
						return response.writeError(500, err);
					}

					response.writeHead(200,{
						"content-type": mimeTypes[filename.split(".").pop()] || mimeTypes.txt
					});
					if(filename.indexOf("index.html") > 0) {
						response.write(injection.viewport);
						response.write(requestParams.query.device !== undefined ? injection.device : browserScript);
						response.write(initialiseScript);
					}
					response.end(file, "binary");
				});
			});
		}

	}).listen(parseInt(argObj.port, 10));

	console.log("listening on port:", argObj.port);
	
}